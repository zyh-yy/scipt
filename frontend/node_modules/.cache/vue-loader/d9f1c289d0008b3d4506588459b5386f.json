{"remainingRequest":"C:\\Users\\zhuyu\\Desktop\\study\\lijialu\\scipt\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\zhuyu\\Desktop\\study\\lijialu\\scipt\\frontend\\src\\views\\Alerts.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\zhuyu\\Desktop\\study\\lijialu\\scipt\\frontend\\src\\views\\Alerts.vue","mtime":1747319151128},{"path":"C:\\Users\\zhuyu\\Desktop\\study\\lijialu\\scipt\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1747314279003},{"path":"C:\\Users\\zhuyu\\Desktop\\study\\lijialu\\scipt\\frontend\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js","mtime":1747314323395},{"path":"C:\\Users\\zhuyu\\Desktop\\study\\lijialu\\scipt\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1747314279003},{"path":"C:\\Users\\zhuyu\\Desktop\\study\\lijialu\\scipt\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":1747314281934}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnDQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogJ0FsZXJ0c1ZpZXcnLA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBhbGVydENvbmZpZ3M6IFtdLA0KICAgICAgbG9hZGluZzogZmFsc2UsDQogICAgICBkaWFsb2dWaXNpYmxlOiBmYWxzZSwNCiAgICAgIGFjdGl2ZUZpbHRlcjogbnVsbCwNCiAgICAgIHNhdmluZzogZmFsc2UsDQogICAgICB0ZXN0aW5nRW1haWw6IGZhbHNlLA0KICAgICAgDQogICAgICBlZGl0aW5nQWxlcnQ6IHsNCiAgICAgICAgaWQ6IG51bGwsDQogICAgICAgIG5hbWU6ICcnLA0KICAgICAgICBkZXNjcmlwdGlvbjogJycsDQogICAgICAgIGFsZXJ0X3R5cGU6ICcnLA0KICAgICAgICBjb25kaXRpb25fdHlwZTogJycsDQogICAgICAgIGNvbmRpdGlvbl92YWx1ZTogJycsDQogICAgICAgIG5vdGlmaWNhdGlvbl90eXBlOiAnZW1haWwnLA0KICAgICAgICBub3RpZmljYXRpb25fY29uZmlnOiB7DQogICAgICAgICAgc210cF9zZXJ2ZXI6ICcnLA0KICAgICAgICAgIHNtdHBfcG9ydDogNTg3LA0KICAgICAgICAgIHVzZXJuYW1lOiAnJywNCiAgICAgICAgICBwYXNzd29yZDogJycsDQogICAgICAgICAgc2VuZGVyOiAnJywNCiAgICAgICAgICByZWNpcGllbnRzOiAnJw0KICAgICAgICB9LA0KICAgICAgICBpc19hY3RpdmU6IDENCiAgICAgIH0sDQogICAgICANCiAgICAgIHJ1bGVzOiB7DQogICAgICAgIG5hbWU6IFt7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36L6T5YWl5ZGK6K2m5ZCN56ewJywgdHJpZ2dlcjogJ2JsdXInIH1dLA0KICAgICAgICBhbGVydF90eXBlOiBbeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+mAieaLqeWRiuitpuexu+WeiycsIHRyaWdnZXI6ICdjaGFuZ2UnIH1dLA0KICAgICAgICBjb25kaXRpb25fdHlwZTogW3sgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fpgInmi6nmnaHku7bnsbvlnosnLCB0cmlnZ2VyOiAnY2hhbmdlJyB9XSwNCiAgICAgICAgY29uZGl0aW9uX3ZhbHVlOiBbeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+i+k+WFpeadoeS7tuWAvCcsIHRyaWdnZXI6ICdibHVyJyB9XSwNCiAgICAgICAgbm90aWZpY2F0aW9uX3R5cGU6IFt7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36YCJ5oup6YCa55+l5pa55byPJywgdHJpZ2dlcjogJ2NoYW5nZScgfV0sDQogICAgICAgICdub3RpZmljYXRpb25fY29uZmlnLnNtdHBfc2VydmVyJzogWw0KICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fovpPlhaVTTVRQ5pyN5Yqh5ZmoJywgdHJpZ2dlcjogJ2JsdXInIH0NCiAgICAgICAgXSwNCiAgICAgICAgJ25vdGlmaWNhdGlvbl9jb25maWcuc210cF9wb3J0JzogWw0KICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fovpPlhaVTTVRQ56uv5Y+jJywgdHJpZ2dlcjogJ2JsdXInIH0NCiAgICAgICAgXSwNCiAgICAgICAgJ25vdGlmaWNhdGlvbl9jb25maWcudXNlcm5hbWUnOiBbDQogICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+i+k+WFpVNNVFDnlKjmiLflkI0nLCB0cmlnZ2VyOiAnYmx1cicgfQ0KICAgICAgICBdLA0KICAgICAgICAnbm90aWZpY2F0aW9uX2NvbmZpZy5wYXNzd29yZCc6IFsNCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36L6T5YWlU01UUOWvhueggScsIHRyaWdnZXI6ICdibHVyJyB9DQogICAgICAgIF0sDQogICAgICAgICdub3RpZmljYXRpb25fY29uZmlnLnNlbmRlcic6IFsNCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36L6T5YWl5Y+R5Lu25Lq6JywgdHJpZ2dlcjogJ2JsdXInIH0NCiAgICAgICAgXSwNCiAgICAgICAgJ25vdGlmaWNhdGlvbl9jb25maWcucmVjaXBpZW50cyc6IFsNCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36L6T5YWl5pS25Lu25Lq6JywgdHJpZ2dlcjogJ2JsdXInIH0NCiAgICAgICAgXQ0KICAgICAgfQ0KICAgIH0NCiAgfSwNCiAgY3JlYXRlZCgpIHsNCiAgICB0aGlzLmxvYWRBbGVydENvbmZpZ3MoKQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgYXN5bmMgbG9hZEFsZXJ0Q29uZmlncygpIHsNCiAgICAgIHRoaXMubG9hZGluZyA9IHRydWUNCiAgICAgIHRyeSB7DQogICAgICAgIGxldCB1cmwgPSAnL2FwaS9hbGVydC9jb25maWcnDQogICAgICAgIGlmICh0aGlzLmFjdGl2ZUZpbHRlciAhPT0gbnVsbCkgew0KICAgICAgICAgIHVybCArPSBgP2lzX2FjdGl2ZT0ke3RoaXMuYWN0aXZlRmlsdGVyfWANCiAgICAgICAgfQ0KICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGF4aW9zLmdldCh1cmwpDQogICAgICAgIGlmIChyZXNwb25zZS5kYXRhLmNvZGUgPT09IDApIHsNCiAgICAgICAgICB0aGlzLmFsZXJ0Q29uZmlncyA9IHJlc3BvbnNlLmRhdGEuZGF0YS5tYXAoY29uZmlnID0+ICh7DQogICAgICAgICAgICAuLi5jb25maWcsDQogICAgICAgICAgICBhbGVydF90eXBlX3RleHQ6IHRoaXMuZ2V0QWxlcnRUeXBlVGV4dChjb25maWcuYWxlcnRfdHlwZSkNCiAgICAgICAgICB9KSkNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHJlc3BvbnNlLmRhdGEubWVzc2FnZSB8fCAn6I635Y+W5ZGK6K2m6YWN572u5YiX6KGo5aSx6LSlJykNCiAgICAgICAgfQ0KICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcign5Yqg6L295ZGK6K2m6YWN572u5aSx6LSlOicsIGVycm9yKQ0KICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfliqDovb3lkYrorabphY3nva7lpLHotKU6ICcgKyBlcnJvci5tZXNzYWdlKQ0KICAgICAgfSBmaW5hbGx5IHsNCiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2UNCiAgICAgIH0NCiAgICB9LA0KDQogICAgZ2V0QWxlcnRUeXBlVGV4dCh0eXBlKSB7DQogICAgICBjb25zdCBtYXAgPSB7DQogICAgICAgICdzY3JpcHRfZmFpbGVkJzogJ+iEmuacrOaJp+ihjOWksei0pScsDQogICAgICAgICdzY3JpcHRfdGltZW91dCc6ICfohJrmnKzmiafooYzotoXml7YnLA0KICAgICAgICAnY2hhaW5fZmFpbGVkJzogJ+mTvuW8j+S7u+WKoeWksei0pScsDQogICAgICAgICdzeXN0ZW1fcmVzb3VyY2UnOiAn57O757uf6LWE5rqQ5ZGK6K2mJw0KICAgICAgfQ0KICAgICAgcmV0dXJuIG1hcFt0eXBlXSB8fCB0eXBlDQogICAgfSwNCg0KICAgIGZvcm1hdENvbmRpdGlvbihjb25maWcpIHsNCiAgICAgIGlmICghY29uZmlnLmNvbmRpdGlvbl90eXBlIHx8ICFjb25maWcuY29uZGl0aW9uX3ZhbHVlKSB7DQogICAgICAgIHJldHVybiAn5pyq6K6+572uJw0KICAgICAgfQ0KDQogICAgICBjb25zdCBjb25kaXRpb25UeXBlTWFwID0gew0KICAgICAgICAnY29uc2VjdXRpdmVfY291bnQnOiAn6L+e57utJywNCiAgICAgICAgJ2NwdV91c2FnZSc6ICdDUFXkvb/nlKjnjocgPicsDQogICAgICAgICdtZW1vcnlfdXNhZ2UnOiAn5YaF5a2Y5L2/55So546HID4nLA0KICAgICAgICAnZGlza191c2FnZSc6ICfno4Hnm5jkvb/nlKjnjocgPicNCiAgICAgIH0NCg0KICAgICAgY29uc3QgdW5pdCA9IGNvbmZpZy5jb25kaXRpb25fdHlwZS5pbmNsdWRlcygndXNhZ2UnKSA/ICclJyA6ICfmrKEnDQogICAgICByZXR1cm4gYCR7Y29uZGl0aW9uVHlwZU1hcFtjb25maWcuY29uZGl0aW9uX3R5cGVdIHx8IGNvbmZpZy5jb25kaXRpb25fdHlwZX0gJHtjb25maWcuY29uZGl0aW9uX3ZhbHVlfSR7dW5pdH1gDQogICAgfSwNCg0KICAgIG9wZW5BbGVydEZvcm0oYWxlcnQgPSBudWxsKSB7DQogICAgICB0aGlzLnJlc2V0Rm9ybSgpDQogICAgICANCiAgICAgIGlmIChhbGVydCkgew0KICAgICAgICBPYmplY3Qua2V5cyh0aGlzLmVkaXRpbmdBbGVydCkuZm9yRWFjaChrZXkgPT4gew0KICAgICAgICAgIGlmIChrZXkgPT09ICdub3RpZmljYXRpb25fY29uZmlnJyAmJiBhbGVydFtrZXldKSB7DQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAvLyDop6PmnpDpgJrnn6XphY3nva4NCiAgICAgICAgICAgICAgY29uc3QgY29uZmlnID0gdHlwZW9mIGFsZXJ0W2tleV0gPT09ICdzdHJpbmcnIA0KICAgICAgICAgICAgICAgID8gSlNPTi5wYXJzZShhbGVydFtrZXldKSANCiAgICAgICAgICAgICAgICA6IGFsZXJ0W2tleV0NCiAgICAgICAgICAgICAgDQogICAgICAgICAgICAgIC8vIOehruS/neaJgOacieWxnuaAp+mDveWtmOWcqA0KICAgICAgICAgICAgICB0aGlzLmVkaXRpbmdBbGVydFtrZXldID0gew0KICAgICAgICAgICAgICAgIHNtdHBfc2VydmVyOiAnJywNCiAgICAgICAgICAgICAgICBzbXRwX3BvcnQ6IDU4NywNCiAgICAgICAgICAgICAgICB1c2VybmFtZTogJycsDQogICAgICAgICAgICAgICAgcGFzc3dvcmQ6ICcnLA0KICAgICAgICAgICAgICAgIHNlbmRlcjogJycsDQogICAgICAgICAgICAgICAgcmVjaXBpZW50czogJycsDQogICAgICAgICAgICAgICAgLi4uY29uZmlnDQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcign6Kej5p6Q6YCa55+l6YWN572u5aSx6LSlOicsIGUpDQogICAgICAgICAgICAgIHRoaXMuZWRpdGluZ0FsZXJ0W2tleV0gPSB7DQogICAgICAgICAgICAgICAgc210cF9zZXJ2ZXI6ICcnLA0KICAgICAgICAgICAgICAgIHNtdHBfcG9ydDogNTg3LA0KICAgICAgICAgICAgICAgIHVzZXJuYW1lOiAnJywNCiAgICAgICAgICAgICAgICBwYXNzd29yZDogJycsDQogICAgICAgICAgICAgICAgc2VuZGVyOiAnJywNCiAgICAgICAgICAgICAgICByZWNpcGllbnRzOiAnJw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgfSBlbHNlIGlmIChhbGVydFtrZXldICE9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIHRoaXMuZWRpdGluZ0FsZXJ0W2tleV0gPSBhbGVydFtrZXldDQogICAgICAgICAgfQ0KICAgICAgICB9KQ0KICAgICAgfQ0KICAgICAgDQogICAgICB0aGlzLmRpYWxvZ1Zpc2libGUgPSB0cnVlDQogICAgfSwNCg0KICAgIHJlc2V0Rm9ybSgpIHsNCiAgICAgIHRoaXMuZWRpdGluZ0FsZXJ0ID0gew0KICAgICAgICBpZDogbnVsbCwNCiAgICAgICAgbmFtZTogJycsDQogICAgICAgIGRlc2NyaXB0aW9uOiAnJywNCiAgICAgICAgYWxlcnRfdHlwZTogJycsDQogICAgICAgIGNvbmRpdGlvbl90eXBlOiAnJywNCiAgICAgICAgY29uZGl0aW9uX3ZhbHVlOiAnJywNCiAgICAgICAgbm90aWZpY2F0aW9uX3R5cGU6ICdlbWFpbCcsDQogICAgICAgIG5vdGlmaWNhdGlvbl9jb25maWc6IHsNCiAgICAgICAgICBzbXRwX3NlcnZlcjogJycsDQogICAgICAgICAgc210cF9wb3J0OiA1ODcsDQogICAgICAgICAgdXNlcm5hbWU6ICcnLA0KICAgICAgICAgIHBhc3N3b3JkOiAnJywNCiAgICAgICAgICBzZW5kZXI6ICcnLA0KICAgICAgICAgIHJlY2lwaWVudHM6ICcnDQogICAgICAgIH0sDQogICAgICAgIGlzX2FjdGl2ZTogMQ0KICAgICAgfQ0KICAgICAgDQogICAgICBpZiAodGhpcy4kcmVmcy5hbGVydEZvcm0pIHsNCiAgICAgICAgdGhpcy4kcmVmcy5hbGVydEZvcm0ucmVzZXRGaWVsZHMoKQ0KICAgICAgfQ0KICAgIH0sDQoNCiAgICBhc3luYyBzYXZlQWxlcnRDb25maWcoKSB7DQogICAgICBpZiAoIXRoaXMuJHJlZnMuYWxlcnRGb3JtKSByZXR1cm4NCiAgICAgIA0KICAgICAgdGhpcy4kcmVmcy5hbGVydEZvcm0udmFsaWRhdGUoYXN5bmMgKHZhbGlkKSA9PiB7DQogICAgICAgIGlmICghdmFsaWQpIHJldHVybg0KICAgICAgICANCiAgICAgICAgdGhpcy5zYXZpbmcgPSB0cnVlDQogICAgICAgIA0KICAgICAgICB0cnkgew0KICAgICAgICAgIC8vIOWHhuWkh+imgeWPkemAgeeahOaVsOaNrg0KICAgICAgICAgIGNvbnN0IGFsZXJ0RGF0YSA9IHsgLi4udGhpcy5lZGl0aW5nQWxlcnQgfQ0KICAgICAgICAgIA0KICAgICAgICAgIC8vIOehruS/nW5vdGlmaWNhdGlvbl9jb25maWfmmK/lrZfnrKbkuLINCiAgICAgICAgICBpZiAodHlwZW9mIGFsZXJ0RGF0YS5ub3RpZmljYXRpb25fY29uZmlnID09PSAnb2JqZWN0Jykgew0KICAgICAgICAgICAgYWxlcnREYXRhLm5vdGlmaWNhdGlvbl9jb25maWcgPSBKU09OLnN0cmluZ2lmeShhbGVydERhdGEubm90aWZpY2F0aW9uX2NvbmZpZykNCiAgICAgICAgICB9DQogICAgICAgICAgDQogICAgICAgICAgbGV0IHJlc3BvbnNlDQogICAgICAgICAgDQogICAgICAgICAgaWYgKHRoaXMuZWRpdGluZ0FsZXJ0LmlkKSB7DQogICAgICAgICAgICAvLyDmm7TmlrDnjrDmnInphY3nva4NCiAgICAgICAgICAgIHJlc3BvbnNlID0gYXdhaXQgYXhpb3MucHV0KGAvYXBpL2FsZXJ0L2NvbmZpZy8ke3RoaXMuZWRpdGluZ0FsZXJ0LmlkfWAsIGFsZXJ0RGF0YSkNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgLy8g5Yib5bu65paw6YWN572uDQogICAgICAgICAgICByZXNwb25zZSA9IGF3YWl0IGF4aW9zLnBvc3QoJy9hcGkvYWxlcnQvY29uZmlnJywgYWxlcnREYXRhKQ0KICAgICAgICAgIH0NCiAgICAgICAgICANCiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5jb2RlID09PSAwKSB7DQogICAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MocmVzcG9uc2UuZGF0YS5tZXNzYWdlIHx8ICfkv53lrZjlkYrorabphY3nva7miJDlip8nKQ0KICAgICAgICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gZmFsc2UNCiAgICAgICAgICAgIHRoaXMubG9hZEFsZXJ0Q29uZmlncygpDQogICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IocmVzcG9uc2UuZGF0YS5tZXNzYWdlIHx8ICfkv53lrZjlkYrorabphY3nva7lpLHotKUnKQ0KICAgICAgICAgIH0NCiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICBjb25zb2xlLmVycm9yKCfkv53lrZjlkYrorabphY3nva7lpLHotKU6JywgZXJyb3IpDQogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign5L+d5a2Y5ZGK6K2m6YWN572u5aSx6LSlOiAnICsgZXJyb3IubWVzc2FnZSkNCiAgICAgICAgfSBmaW5hbGx5IHsNCiAgICAgICAgICB0aGlzLnNhdmluZyA9IGZhbHNlDQogICAgICAgIH0NCiAgICAgIH0pDQogICAgfSwNCg0KICAgIGFzeW5jIHRlc3RFbWFpbCgpIHsNCiAgICAgIGlmICghdGhpcy5lZGl0aW5nQWxlcnQubm90aWZpY2F0aW9uX2NvbmZpZykgcmV0dXJuDQogICAgICANCiAgICAgIGNvbnN0IGNvbmZpZyA9IHRoaXMuZWRpdGluZ0FsZXJ0Lm5vdGlmaWNhdGlvbl9jb25maWcNCiAgICAgIA0KICAgICAgLy8g6aqM6K+B5b+F5aGr5a2X5q61DQogICAgICBpZiAoIWNvbmZpZy5zbXRwX3NlcnZlciB8fCAhY29uZmlnLnNtdHBfcG9ydCB8fCAhY29uZmlnLnVzZXJuYW1lIHx8IA0KICAgICAgICAgICFjb25maWcucGFzc3dvcmQgfHwgIWNvbmZpZy5zZW5kZXIgfHwgIWNvbmZpZy5yZWNpcGllbnRzKSB7DQogICAgICAgIHRoaXMuJG1lc3NhZ2Uud2FybmluZygn6K+35aGr5YaZ5a6M5pW055qE6YKu5Lu26YWN572u5L+h5oGvJykNCiAgICAgICAgcmV0dXJuDQogICAgICB9DQogICAgICANCiAgICAgIHRoaXMudGVzdGluZ0VtYWlsID0gdHJ1ZQ0KICAgICAgDQogICAgICB0cnkgew0KICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGF4aW9zLnBvc3QoJy9hcGkvYWxlcnQvdGVzdC1lbWFpbCcsIHsNCiAgICAgICAgICBzbXRwX3NlcnZlcjogY29uZmlnLnNtdHBfc2VydmVyLA0KICAgICAgICAgIHNtdHBfcG9ydDogY29uZmlnLnNtdHBfcG9ydCwNCiAgICAgICAgICB1c2VybmFtZTogY29uZmlnLnVzZXJuYW1lLA0KICAgICAgICAgIHBhc3N3b3JkOiBjb25maWcucGFzc3dvcmQsDQogICAgICAgICAgc2VuZGVyOiBjb25maWcuc2VuZGVyLA0KICAgICAgICAgIHJlY2lwaWVudHM6IGNvbmZpZy5yZWNpcGllbnRzDQogICAgICAgIH0pDQogICAgICAgIA0KICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5jb2RlID09PSAwKSB7DQogICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCfmtYvor5Xpgq7ku7blj5HpgIHmiJDlip/vvIzor7fmo4Dmn6XmlLbku7bnrrEnKQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IocmVzcG9uc2UuZGF0YS5tZXNzYWdlIHx8ICfmtYvor5Xpgq7ku7blj5HpgIHlpLHotKUnKQ0KICAgICAgICB9DQogICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCfmtYvor5Xpgq7ku7blj5HpgIHlpLHotKU6JywgZXJyb3IpDQogICAgICAgIGNvbnN0IGVycm9yTXNnID0gZXJyb3IucmVzcG9uc2UgJiYgZXJyb3IucmVzcG9uc2UuZGF0YSAmJiBlcnJvci5yZXNwb25zZS5kYXRhLm1lc3NhZ2UgDQogICAgICAgICAgPyBlcnJvci5yZXNwb25zZS5kYXRhLm1lc3NhZ2UgDQogICAgICAgICAgOiBlcnJvci5tZXNzYWdlOw0KICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfmtYvor5Xpgq7ku7blj5HpgIHlpLHotKU6ICcgKyBlcnJvck1zZyk7DQogICAgICB9IGZpbmFsbHkgew0KICAgICAgICB0aGlzLnRlc3RpbmdFbWFpbCA9IGZhbHNlDQogICAgICB9DQogICAgfSwNCg0KICAgIGFzeW5jIHRvZ2dsZUFjdGl2ZShhbGVydCkgew0KICAgICAgdHJ5IHsNCiAgICAgICAgY29uc3QgbmV3U3RhdHVzID0gYWxlcnQuaXNfYWN0aXZlID8gMCA6IDENCiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5wdXQoYC9hcGkvYWxlcnQvY29uZmlnLyR7YWxlcnQuaWR9L2FjdGl2ZWAsIHsNCiAgICAgICAgICBpc19hY3RpdmU6IG5ld1N0YXR1cw0KICAgICAgICB9KQ0KICAgICAgICANCiAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuY29kZSA9PT0gMCkgew0KICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2VzcyhyZXNwb25zZS5kYXRhLm1lc3NhZ2UgfHwgYOWRiuitpumFjee9riR7bmV3U3RhdHVzID8gJ+WQr+eUqCcgOiAn56aB55SoJ33miJDlip9gKQ0KICAgICAgICAgIHRoaXMubG9hZEFsZXJ0Q29uZmlncygpDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXNwb25zZS5kYXRhLm1lc3NhZ2UgfHwgJ+aTjeS9nOWksei0pScpDQogICAgICAgIH0NCiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+WIh+aNouWRiuitpueKtuaAgeWksei0pTonLCBlcnJvcikNCiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign5pON5L2c5aSx6LSlOiAnICsgZXJyb3IubWVzc2FnZSkNCiAgICAgIH0NCiAgICB9LA0KDQogICAgY29uZmlybURlbGV0ZShhbGVydCkgew0KICAgICAgdGhpcy4kY29uZmlybSgNCiAgICAgICAgYOehruWumuimgeWIoOmZpOWRiuitpumFjee9riAiJHthbGVydC5uYW1lfSIg5ZCX77yf5Yig6Zmk5ZCO5bCG5peg5rOV5oGi5aSN44CCYCwNCiAgICAgICAgJ+WIoOmZpOehruiupCcsDQogICAgICAgIHsNCiAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicsDQogICAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WPlua2iCcsDQogICAgICAgICAgdHlwZTogJ3dhcm5pbmcnDQogICAgICAgIH0NCiAgICAgICkudGhlbihhc3luYyAoKSA9PiB7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5kZWxldGUoYC9hcGkvYWxlcnQvY29uZmlnLyR7YWxlcnQuaWR9YCkNCiAgICAgICAgICANCiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5jb2RlID09PSAwKSB7DQogICAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ+WIoOmZpOWRiuitpumFjee9ruaIkOWKnycpDQogICAgICAgICAgICB0aGlzLmxvYWRBbGVydENvbmZpZ3MoKQ0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHJlc3BvbnNlLmRhdGEubWVzc2FnZSB8fCAn5Yig6Zmk5ZGK6K2m6YWN572u5aSx6LSlJykNCiAgICAgICAgICB9DQogICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgY29uc29sZS5lcnJvcign5Yig6Zmk5ZGK6K2m6YWN572u5aSx6LSlOicsIGVycm9yKQ0KICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+WIoOmZpOWRiuitpumFjee9ruWksei0pTogJyArIGVycm9yLm1lc3NhZ2UpDQogICAgICAgIH0NCiAgICAgIH0pLmNhdGNoKCgpID0+IHt9KQ0KICAgIH0sDQoNCiAgICB2aWV3SGlzdG9yeShjb25maWdJZCkgew0KICAgICAgdGhpcy4kcm91dGVyLnB1c2goYC9hbGVydC9oaXN0b3J5P2NvbmZpZ19pZD0ke2NvbmZpZ0lkfWApDQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["Alerts.vue"],"names":[],"mappings":";AAyOA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"Alerts.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"alerts-container\">\r\n    <div class=\"page-header\">\r\n      <h1>告警配置</h1>\r\n      <el-button type=\"primary\" @click=\"openAlertForm()\">添加告警</el-button>\r\n    </div>\r\n\r\n    <el-card class=\"filter-card\">\r\n      <div class=\"filter-container\">\r\n        <el-radio-group v-model=\"activeFilter\" @change=\"loadAlertConfigs\">\r\n          <el-radio-button :label=\"null\">全部</el-radio-button>\r\n          <el-radio-button :label=\"1\">已启用</el-radio-button>\r\n          <el-radio-button :label=\"0\">已禁用</el-radio-button>\r\n        </el-radio-group>\r\n      </div>\r\n    </el-card>\r\n\r\n    <el-table\r\n      v-loading=\"loading\"\r\n      :data=\"alertConfigs\"\r\n      stripe\r\n      style=\"width: 100%; margin-top: 20px\"\r\n    >\r\n      <el-table-column prop=\"id\" label=\"ID\" width=\"80\" />\r\n      <el-table-column prop=\"name\" label=\"告警名称\" min-width=\"180\" />\r\n      <el-table-column prop=\"alert_type_text\" label=\"告警类型\" width=\"120\" />\r\n      <el-table-column label=\"告警条件\" min-width=\"200\">\r\n        <template slot-scope=\"scope\">\r\n          <div>{{ formatCondition(scope.row) }}</div>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"通知方式\" width=\"120\">\r\n        <template slot-scope=\"scope\">\r\n          <div>{{ scope.row.notification_type === 'email' ? '邮件' : '其他' }}</div>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"状态\" width=\"100\">\r\n        <template slot-scope=\"scope\">\r\n          <el-tag :type=\"scope.row.is_active ? 'success' : 'info'\">\r\n            {{ scope.row.is_active ? '已启用' : '已禁用' }}\r\n          </el-tag>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"操作\" width=\"240\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button \r\n            size=\"small\"\r\n            type=\"primary\" \r\n            plain\r\n            @click=\"viewHistory(scope.row.id)\"\r\n          >\r\n            历史记录\r\n          </el-button>\r\n          <el-button \r\n            size=\"small\"\r\n            type=\"success\" \r\n            plain\r\n            @click=\"toggleActive(scope.row)\"\r\n          >\r\n            {{ scope.row.is_active ? '禁用' : '启用' }}\r\n          </el-button>\r\n          <el-button \r\n            size=\"small\"\r\n            type=\"warning\" \r\n            plain\r\n            @click=\"openAlertForm(scope.row)\"\r\n          >\r\n            编辑\r\n          </el-button>\r\n          <el-button \r\n            size=\"small\"\r\n            type=\"danger\" \r\n            plain\r\n            @click=\"confirmDelete(scope.row)\"\r\n          >\r\n            删除\r\n          </el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <!-- 告警配置表单对话框 -->\r\n    <el-dialog\r\n      :title=\"editingAlert.id ? '编辑告警配置' : '添加告警配置'\"\r\n      :visible.sync=\"dialogVisible\"\r\n      width=\"60%\"\r\n    >\r\n      <el-form \r\n        :model=\"editingAlert\" \r\n        :rules=\"rules\" \r\n        ref=\"alertForm\" \r\n        label-width=\"120px\"\r\n      >\r\n        <el-form-item label=\"告警名称\" prop=\"name\">\r\n          <el-input v-model=\"editingAlert.name\" placeholder=\"请输入告警名称\" />\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"告警类型\" prop=\"alert_type\">\r\n          <el-select v-model=\"editingAlert.alert_type\" placeholder=\"请选择告警类型\" style=\"width: 100%\">\r\n            <el-option label=\"脚本执行失败\" value=\"script_failed\" />\r\n            <el-option label=\"脚本执行超时\" value=\"script_timeout\" />\r\n            <el-option label=\"链式任务失败\" value=\"chain_failed\" />\r\n            <el-option label=\"系统资源告警\" value=\"system_resource\" />\r\n          </el-select>\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"告警条件\" required>\r\n          <el-row :gutter=\"10\">\r\n            <el-col :span=\"8\">\r\n              <el-form-item prop=\"condition_type\">\r\n                <el-select v-model=\"editingAlert.condition_type\" placeholder=\"条件类型\" style=\"width: 100%\">\r\n                  <el-option label=\"连续次数\" value=\"consecutive_count\" />\r\n                  <el-option label=\"CPU使用率\" value=\"cpu_usage\" v-if=\"editingAlert.alert_type === 'system_resource'\" />\r\n                  <el-option label=\"内存使用率\" value=\"memory_usage\" v-if=\"editingAlert.alert_type === 'system_resource'\" />\r\n                  <el-option label=\"磁盘使用率\" value=\"disk_usage\" v-if=\"editingAlert.alert_type === 'system_resource'\" />\r\n                </el-select>\r\n              </el-form-item>\r\n            </el-col>\r\n            <el-col :span=\"16\">\r\n              <el-form-item prop=\"condition_value\">\r\n                <el-input v-model=\"editingAlert.condition_value\" placeholder=\"条件值\">\r\n                  <template slot=\"append\" v-if=\"editingAlert.condition_type && editingAlert.condition_type.includes('usage')\">%</template>\r\n                  <template slot=\"append\" v-else>次</template>\r\n                </el-input>\r\n              </el-form-item>\r\n            </el-col>\r\n          </el-row>\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"通知方式\" prop=\"notification_type\">\r\n          <el-select v-model=\"editingAlert.notification_type\" placeholder=\"请选择通知方式\" style=\"width: 100%\">\r\n            <el-option label=\"邮件通知\" value=\"email\" />\r\n          </el-select>\r\n        </el-form-item>\r\n        \r\n        <el-form-item \r\n          label=\"收件人\" \r\n          prop=\"notification_config.recipients\"\r\n          v-if=\"editingAlert.notification_type === 'email'\"\r\n        >\r\n          <el-input \r\n            v-model=\"editingAlert.notification_config.recipients\" \r\n            placeholder=\"多个收件人请用逗号分隔\" \r\n          />\r\n          <div class=\"hint-text\">多个收件人请用逗号分隔</div>\r\n        </el-form-item>\r\n        \r\n        <el-form-item \r\n          label=\"SMTP服务器\" \r\n          prop=\"notification_config.smtp_server\"\r\n          v-if=\"editingAlert.notification_type === 'email'\"\r\n        >\r\n          <el-input v-model=\"editingAlert.notification_config.smtp_server\" placeholder=\"例如: smtp.example.com\" />\r\n        </el-form-item>\r\n        \r\n        <el-form-item \r\n          label=\"SMTP端口\" \r\n          prop=\"notification_config.smtp_port\"\r\n          v-if=\"editingAlert.notification_type === 'email'\"\r\n        >\r\n          <el-input-number v-model=\"editingAlert.notification_config.smtp_port\" :min=\"1\" :max=\"65535\" />\r\n        </el-form-item>\r\n        \r\n        <el-form-item \r\n          label=\"SMTP用户名\" \r\n          prop=\"notification_config.username\"\r\n          v-if=\"editingAlert.notification_type === 'email'\"\r\n        >\r\n          <el-input v-model=\"editingAlert.notification_config.username\" placeholder=\"例如: user@example.com\" />\r\n        </el-form-item>\r\n        \r\n        <el-form-item \r\n          label=\"SMTP密码\" \r\n          prop=\"notification_config.password\"\r\n          v-if=\"editingAlert.notification_type === 'email'\"\r\n        >\r\n          <el-input \r\n            v-model=\"editingAlert.notification_config.password\"\r\n            placeholder=\"SMTP密码\" \r\n            show-password\r\n          />\r\n        </el-form-item>\r\n        \r\n        <el-form-item \r\n          label=\"发件人\" \r\n          prop=\"notification_config.sender\"\r\n          v-if=\"editingAlert.notification_type === 'email'\"\r\n        >\r\n          <el-input v-model=\"editingAlert.notification_config.sender\" placeholder=\"例如: Script Platform <noreply@example.com>\" />\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"描述\" prop=\"description\">\r\n          <el-input \r\n            v-model=\"editingAlert.description\" \r\n            type=\"textarea\" \r\n            :rows=\"3\" \r\n            placeholder=\"请输入告警配置描述\"\r\n          />\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"状态\" v-if=\"editingAlert.id\">\r\n          <el-switch\r\n            v-model=\"editingAlert.is_active\"\r\n            :active-value=\"1\"\r\n            :inactive-value=\"0\"\r\n            active-text=\"启用\"\r\n            inactive-text=\"禁用\"\r\n          />\r\n        </el-form-item>\r\n      </el-form>\r\n      \r\n      <div class=\"dialog-footer\" v-if=\"editingAlert.notification_type === 'email'\">\r\n        <el-button \r\n          type=\"primary\" \r\n          plain\r\n          @click=\"testEmail\" \r\n          :loading=\"testingEmail\"\r\n        >\r\n          测试邮件配置\r\n        </el-button>\r\n      </div>\r\n      \r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"dialogVisible = false\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"saveAlertConfig\" :loading=\"saving\">\r\n          保存\r\n        </el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\n\r\nexport default {\r\n  name: 'AlertsView',\r\n  data() {\r\n    return {\r\n      alertConfigs: [],\r\n      loading: false,\r\n      dialogVisible: false,\r\n      activeFilter: null,\r\n      saving: false,\r\n      testingEmail: false,\r\n      \r\n      editingAlert: {\r\n        id: null,\r\n        name: '',\r\n        description: '',\r\n        alert_type: '',\r\n        condition_type: '',\r\n        condition_value: '',\r\n        notification_type: 'email',\r\n        notification_config: {\r\n          smtp_server: '',\r\n          smtp_port: 587,\r\n          username: '',\r\n          password: '',\r\n          sender: '',\r\n          recipients: ''\r\n        },\r\n        is_active: 1\r\n      },\r\n      \r\n      rules: {\r\n        name: [{ required: true, message: '请输入告警名称', trigger: 'blur' }],\r\n        alert_type: [{ required: true, message: '请选择告警类型', trigger: 'change' }],\r\n        condition_type: [{ required: true, message: '请选择条件类型', trigger: 'change' }],\r\n        condition_value: [{ required: true, message: '请输入条件值', trigger: 'blur' }],\r\n        notification_type: [{ required: true, message: '请选择通知方式', trigger: 'change' }],\r\n        'notification_config.smtp_server': [\r\n          { required: true, message: '请输入SMTP服务器', trigger: 'blur' }\r\n        ],\r\n        'notification_config.smtp_port': [\r\n          { required: true, message: '请输入SMTP端口', trigger: 'blur' }\r\n        ],\r\n        'notification_config.username': [\r\n          { required: true, message: '请输入SMTP用户名', trigger: 'blur' }\r\n        ],\r\n        'notification_config.password': [\r\n          { required: true, message: '请输入SMTP密码', trigger: 'blur' }\r\n        ],\r\n        'notification_config.sender': [\r\n          { required: true, message: '请输入发件人', trigger: 'blur' }\r\n        ],\r\n        'notification_config.recipients': [\r\n          { required: true, message: '请输入收件人', trigger: 'blur' }\r\n        ]\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n    this.loadAlertConfigs()\r\n  },\r\n  methods: {\r\n    async loadAlertConfigs() {\r\n      this.loading = true\r\n      try {\r\n        let url = '/api/alert/config'\r\n        if (this.activeFilter !== null) {\r\n          url += `?is_active=${this.activeFilter}`\r\n        }\r\n        const response = await axios.get(url)\r\n        if (response.data.code === 0) {\r\n          this.alertConfigs = response.data.data.map(config => ({\r\n            ...config,\r\n            alert_type_text: this.getAlertTypeText(config.alert_type)\r\n          }))\r\n        } else {\r\n          this.$message.error(response.data.message || '获取告警配置列表失败')\r\n        }\r\n      } catch (error) {\r\n        console.error('加载告警配置失败:', error)\r\n        this.$message.error('加载告警配置失败: ' + error.message)\r\n      } finally {\r\n        this.loading = false\r\n      }\r\n    },\r\n\r\n    getAlertTypeText(type) {\r\n      const map = {\r\n        'script_failed': '脚本执行失败',\r\n        'script_timeout': '脚本执行超时',\r\n        'chain_failed': '链式任务失败',\r\n        'system_resource': '系统资源告警'\r\n      }\r\n      return map[type] || type\r\n    },\r\n\r\n    formatCondition(config) {\r\n      if (!config.condition_type || !config.condition_value) {\r\n        return '未设置'\r\n      }\r\n\r\n      const conditionTypeMap = {\r\n        'consecutive_count': '连续',\r\n        'cpu_usage': 'CPU使用率 >',\r\n        'memory_usage': '内存使用率 >',\r\n        'disk_usage': '磁盘使用率 >'\r\n      }\r\n\r\n      const unit = config.condition_type.includes('usage') ? '%' : '次'\r\n      return `${conditionTypeMap[config.condition_type] || config.condition_type} ${config.condition_value}${unit}`\r\n    },\r\n\r\n    openAlertForm(alert = null) {\r\n      this.resetForm()\r\n      \r\n      if (alert) {\r\n        Object.keys(this.editingAlert).forEach(key => {\r\n          if (key === 'notification_config' && alert[key]) {\r\n            try {\r\n              // 解析通知配置\r\n              const config = typeof alert[key] === 'string' \r\n                ? JSON.parse(alert[key]) \r\n                : alert[key]\r\n              \r\n              // 确保所有属性都存在\r\n              this.editingAlert[key] = {\r\n                smtp_server: '',\r\n                smtp_port: 587,\r\n                username: '',\r\n                password: '',\r\n                sender: '',\r\n                recipients: '',\r\n                ...config\r\n              }\r\n            } catch (e) {\r\n              console.error('解析通知配置失败:', e)\r\n              this.editingAlert[key] = {\r\n                smtp_server: '',\r\n                smtp_port: 587,\r\n                username: '',\r\n                password: '',\r\n                sender: '',\r\n                recipients: ''\r\n              }\r\n            }\r\n          } else if (alert[key] !== undefined) {\r\n            this.editingAlert[key] = alert[key]\r\n          }\r\n        })\r\n      }\r\n      \r\n      this.dialogVisible = true\r\n    },\r\n\r\n    resetForm() {\r\n      this.editingAlert = {\r\n        id: null,\r\n        name: '',\r\n        description: '',\r\n        alert_type: '',\r\n        condition_type: '',\r\n        condition_value: '',\r\n        notification_type: 'email',\r\n        notification_config: {\r\n          smtp_server: '',\r\n          smtp_port: 587,\r\n          username: '',\r\n          password: '',\r\n          sender: '',\r\n          recipients: ''\r\n        },\r\n        is_active: 1\r\n      }\r\n      \r\n      if (this.$refs.alertForm) {\r\n        this.$refs.alertForm.resetFields()\r\n      }\r\n    },\r\n\r\n    async saveAlertConfig() {\r\n      if (!this.$refs.alertForm) return\r\n      \r\n      this.$refs.alertForm.validate(async (valid) => {\r\n        if (!valid) return\r\n        \r\n        this.saving = true\r\n        \r\n        try {\r\n          // 准备要发送的数据\r\n          const alertData = { ...this.editingAlert }\r\n          \r\n          // 确保notification_config是字符串\r\n          if (typeof alertData.notification_config === 'object') {\r\n            alertData.notification_config = JSON.stringify(alertData.notification_config)\r\n          }\r\n          \r\n          let response\r\n          \r\n          if (this.editingAlert.id) {\r\n            // 更新现有配置\r\n            response = await axios.put(`/api/alert/config/${this.editingAlert.id}`, alertData)\r\n          } else {\r\n            // 创建新配置\r\n            response = await axios.post('/api/alert/config', alertData)\r\n          }\r\n          \r\n          if (response.data.code === 0) {\r\n            this.$message.success(response.data.message || '保存告警配置成功')\r\n            this.dialogVisible = false\r\n            this.loadAlertConfigs()\r\n          } else {\r\n            this.$message.error(response.data.message || '保存告警配置失败')\r\n          }\r\n        } catch (error) {\r\n          console.error('保存告警配置失败:', error)\r\n          this.$message.error('保存告警配置失败: ' + error.message)\r\n        } finally {\r\n          this.saving = false\r\n        }\r\n      })\r\n    },\r\n\r\n    async testEmail() {\r\n      if (!this.editingAlert.notification_config) return\r\n      \r\n      const config = this.editingAlert.notification_config\r\n      \r\n      // 验证必填字段\r\n      if (!config.smtp_server || !config.smtp_port || !config.username || \r\n          !config.password || !config.sender || !config.recipients) {\r\n        this.$message.warning('请填写完整的邮件配置信息')\r\n        return\r\n      }\r\n      \r\n      this.testingEmail = true\r\n      \r\n      try {\r\n        const response = await axios.post('/api/alert/test-email', {\r\n          smtp_server: config.smtp_server,\r\n          smtp_port: config.smtp_port,\r\n          username: config.username,\r\n          password: config.password,\r\n          sender: config.sender,\r\n          recipients: config.recipients\r\n        })\r\n        \r\n        if (response.data.code === 0) {\r\n          this.$message.success('测试邮件发送成功，请检查收件箱')\r\n        } else {\r\n          this.$message.error(response.data.message || '测试邮件发送失败')\r\n        }\r\n      } catch (error) {\r\n        console.error('测试邮件发送失败:', error)\r\n        const errorMsg = error.response && error.response.data && error.response.data.message \r\n          ? error.response.data.message \r\n          : error.message;\r\n        this.$message.error('测试邮件发送失败: ' + errorMsg);\r\n      } finally {\r\n        this.testingEmail = false\r\n      }\r\n    },\r\n\r\n    async toggleActive(alert) {\r\n      try {\r\n        const newStatus = alert.is_active ? 0 : 1\r\n        const response = await axios.put(`/api/alert/config/${alert.id}/active`, {\r\n          is_active: newStatus\r\n        })\r\n        \r\n        if (response.data.code === 0) {\r\n          this.$message.success(response.data.message || `告警配置${newStatus ? '启用' : '禁用'}成功`)\r\n          this.loadAlertConfigs()\r\n        } else {\r\n          this.$message.error(response.data.message || '操作失败')\r\n        }\r\n      } catch (error) {\r\n        console.error('切换告警状态失败:', error)\r\n        this.$message.error('操作失败: ' + error.message)\r\n      }\r\n    },\r\n\r\n    confirmDelete(alert) {\r\n      this.$confirm(\r\n        `确定要删除告警配置 \"${alert.name}\" 吗？删除后将无法恢复。`,\r\n        '删除确认',\r\n        {\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n        }\r\n      ).then(async () => {\r\n        try {\r\n          const response = await axios.delete(`/api/alert/config/${alert.id}`)\r\n          \r\n          if (response.data.code === 0) {\r\n            this.$message.success('删除告警配置成功')\r\n            this.loadAlertConfigs()\r\n          } else {\r\n            this.$message.error(response.data.message || '删除告警配置失败')\r\n          }\r\n        } catch (error) {\r\n          console.error('删除告警配置失败:', error)\r\n          this.$message.error('删除告警配置失败: ' + error.message)\r\n        }\r\n      }).catch(() => {})\r\n    },\r\n\r\n    viewHistory(configId) {\r\n      this.$router.push(`/alert/history?config_id=${configId}`)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.alerts-container {\r\n  padding: 20px;\r\n}\r\n\r\n.page-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.filter-card {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.filter-container {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.dialog-footer {\r\n  margin-top: 20px;\r\n  text-align: right;\r\n}\r\n\r\n.hint-text {\r\n  font-size: 12px;\r\n  color: #909399;\r\n  margin-top: 5px;\r\n}\r\n</style>\r\n"]}]}