{"remainingRequest":"C:\\Users\\zhuyu\\Desktop\\study\\lijialu\\scipt\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\zhuyu\\Desktop\\study\\lijialu\\scipt\\frontend\\src\\views\\ChainForm.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\zhuyu\\Desktop\\study\\lijialu\\scipt\\frontend\\src\\views\\ChainForm.vue","mtime":1747313407929},{"path":"C:\\Users\\zhuyu\\Desktop\\study\\lijialu\\scipt\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1747314279003},{"path":"C:\\Users\\zhuyu\\Desktop\\study\\lijialu\\scipt\\frontend\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js","mtime":1747314323395},{"path":"C:\\Users\\zhuyu\\Desktop\\study\\lijialu\\scipt\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1747314279003},{"path":"C:\\Users\\zhuyu\\Desktop\\study\\lijialu\\scipt\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":1747314281934}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICdDaGFpbkZvcm0nLA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBpc0VkaXQ6IGZhbHNlLA0KICAgICAgY2hhaW5JZDogbnVsbCwNCiAgICAgIGZvcm06IHsNCiAgICAgICAgbmFtZTogJycsDQogICAgICAgIGRlc2NyaXB0aW9uOiAnJywNCiAgICAgICAgbm9kZXM6IFtdDQogICAgICB9LA0KICAgICAgcnVsZXM6IHsNCiAgICAgICAgbmFtZTogWw0KICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fovpPlhaXohJrmnKzpk77lkI3np7AnLCB0cmlnZ2VyOiAnYmx1cicgfSwNCiAgICAgICAgICB7IG1pbjogMiwgbWF4OiA1MCwgbWVzc2FnZTogJ+mVv+W6puWcqCAyIOWIsCA1MCDkuKrlrZfnrKYnLCB0cmlnZ2VyOiAnYmx1cicgfQ0KICAgICAgICBdDQogICAgICB9LA0KICAgICAgbG9hZGluZzogZmFsc2UsDQogICAgICBzdWJtaXR0aW5nOiBmYWxzZSwNCiAgICAgIHNjcmlwdFNlbGVjdG9yVmlzaWJsZTogZmFsc2UsDQogICAgICBhdmFpbGFibGVTY3JpcHRzOiBbXSwNCiAgICAgIHNjcmlwdHNMb2FkaW5nOiBmYWxzZQ0KICAgIH07DQogIH0sDQogIGNyZWF0ZWQoKSB7DQogICAgLy8g5Yik5pat5piv5ZCm5Li657yW6L6R5qih5byPDQogICAgdGhpcy5jaGFpbklkID0gdGhpcy4kcm91dGUucGFyYW1zLmlkOw0KICAgIHRoaXMuaXNFZGl0ID0gdGhpcy4kcm91dGUubmFtZSA9PT0gJ0NoYWluRWRpdCc7DQogICAgDQogICAgaWYgKHRoaXMuaXNFZGl0KSB7DQogICAgICB0aGlzLmZldGNoQ2hhaW5EZXRhaWwoKTsNCiAgICB9DQogICAgDQogICAgLy8g6I635Y+W5Y+v55So6ISa5pys5YiX6KGoDQogICAgdGhpcy5mZXRjaFNjcmlwdHMoKTsNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIGZldGNoQ2hhaW5EZXRhaWwoKSB7DQogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlOw0KICAgICAgdGhpcy4kYXhpb3MuZ2V0KGAvYXBpL2NoYWlucy8ke3RoaXMuY2hhaW5JZH1gKQ0KICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7DQogICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuY29kZSA9PT0gMCkgew0KICAgICAgICAgICAgY29uc3QgY2hhaW4gPSByZXNwb25zZS5kYXRhLmRhdGE7DQogICAgICAgICAgICB0aGlzLmZvcm0ubmFtZSA9IGNoYWluLm5hbWU7DQogICAgICAgICAgICB0aGlzLmZvcm0uZGVzY3JpcHRpb24gPSBjaGFpbi5kZXNjcmlwdGlvbjsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8g5aSE55CG6IqC54K5DQogICAgICAgICAgICBpZiAoY2hhaW4ubm9kZXMgJiYgY2hhaW4ubm9kZXMubGVuZ3RoKSB7DQogICAgICAgICAgICAgIHRoaXMuZm9ybS5ub2RlcyA9IGNoYWluLm5vZGVzLm1hcChub2RlID0+ICh7DQogICAgICAgICAgICAgICAgc2NyaXB0X2lkOiBub2RlLnNjcmlwdF9pZCwNCiAgICAgICAgICAgICAgICBzY3JpcHRfbmFtZTogbm9kZS5zY3JpcHRfbmFtZSwNCiAgICAgICAgICAgICAgICBzY3JpcHRfZGVzY3JpcHRpb246IG5vZGUuc2NyaXB0X2Rlc2NyaXB0aW9uLA0KICAgICAgICAgICAgICAgIGZpbGVfdHlwZTogbm9kZS5maWxlX3R5cGUsDQogICAgICAgICAgICAgICAgbm9kZV9vcmRlcjogbm9kZS5ub2RlX29yZGVyDQogICAgICAgICAgICAgIH0pKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXNwb25zZS5kYXRhLm1lc3NhZ2UgfHwgJ+iOt+WPluiEmuacrOmTvuivpuaDheWksei0pScpOw0KICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy9jaGFpbnMnKTsNCiAgICAgICAgICB9DQogICAgICAgIH0pDQogICAgICAgIC5jYXRjaChlcnJvciA9PiB7DQogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign6I635Y+W6ISa5pys6ZO+6K+m5oOF5aSx6LSlOiAnICsgZXJyb3IubWVzc2FnZSk7DQogICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy9jaGFpbnMnKTsNCiAgICAgICAgfSkNCiAgICAgICAgLmZpbmFsbHkoKCkgPT4gew0KICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOw0KICAgICAgICB9KTsNCiAgICB9LA0KICAgIGZldGNoU2NyaXB0cygpIHsNCiAgICAgIHRoaXMuc2NyaXB0c0xvYWRpbmcgPSB0cnVlOw0KICAgICAgdGhpcy4kYXhpb3MuZ2V0KCcvYXBpL3NjcmlwdHMnKQ0KICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7DQogICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuY29kZSA9PT0gMCkgew0KICAgICAgICAgICAgdGhpcy5hdmFpbGFibGVTY3JpcHRzID0gcmVzcG9uc2UuZGF0YS5kYXRhIHx8IFtdOw0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHJlc3BvbnNlLmRhdGEubWVzc2FnZSB8fCAn6I635Y+W6ISa5pys5YiX6KGo5aSx6LSlJyk7DQogICAgICAgICAgfQ0KICAgICAgICB9KQ0KICAgICAgICAuY2F0Y2goZXJyb3IgPT4gew0KICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+iOt+WPluiEmuacrOWIl+ihqOWksei0pTogJyArIGVycm9yLm1lc3NhZ2UpOw0KICAgICAgICB9KQ0KICAgICAgICAuZmluYWxseSgoKSA9PiB7DQogICAgICAgICAgdGhpcy5zY3JpcHRzTG9hZGluZyA9IGZhbHNlOw0KICAgICAgICB9KTsNCiAgICB9LA0KICAgIHNob3dTY3JpcHRTZWxlY3RvcigpIHsNCiAgICAgIHRoaXMuc2NyaXB0U2VsZWN0b3JWaXNpYmxlID0gdHJ1ZTsNCiAgICB9LA0KICAgIGhhbmRsZVNjcmlwdENsaWNrKHJvdykgew0KICAgICAgLy8g5qOA5p+l5piv5ZCm5bey57uP5re75Yqg6L+H6K+l6ISa5pysDQogICAgICBjb25zdCBleGlzdHMgPSB0aGlzLmZvcm0ubm9kZXMuc29tZShub2RlID0+IG5vZGUuc2NyaXB0X2lkID09PSByb3cuaWQpOw0KICAgICAgaWYgKGV4aXN0cykgew0KICAgICAgICB0aGlzLiRtZXNzYWdlLndhcm5pbmcoJ+ivpeiEmuacrOW3sua3u+WKoOWIsOiEmuacrOmTvuS4rScpOw0KICAgICAgICByZXR1cm47DQogICAgICB9DQogICAgICANCiAgICAgIC8vIOa3u+WKoOWIsOiKgueCueWIl+ihqA0KICAgICAgdGhpcy5mb3JtLm5vZGVzLnB1c2goew0KICAgICAgICBzY3JpcHRfaWQ6IHJvdy5pZCwNCiAgICAgICAgc2NyaXB0X25hbWU6IHJvdy5uYW1lLA0KICAgICAgICBzY3JpcHRfZGVzY3JpcHRpb246IHJvdy5kZXNjcmlwdGlvbiwNCiAgICAgICAgZmlsZV90eXBlOiByb3cuZmlsZV90eXBlLA0KICAgICAgICBub2RlX29yZGVyOiB0aGlzLmZvcm0ubm9kZXMubGVuZ3RoICsgMQ0KICAgICAgfSk7DQogICAgICANCiAgICAgIHRoaXMuc2NyaXB0U2VsZWN0b3JWaXNpYmxlID0gZmFsc2U7DQogICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoYOW3sua3u+WKoOiEmuacrDogJHtyb3cubmFtZX1gKTsNCiAgICB9LA0KICAgIG1vdmVVcChpbmRleCkgew0KICAgICAgaWYgKGluZGV4ID09PSAwKSByZXR1cm47DQogICAgICANCiAgICAgIGNvbnN0IHRlbXAgPSB0aGlzLmZvcm0ubm9kZXNbaW5kZXhdOw0KICAgICAgdGhpcy5mb3JtLm5vZGVzLnNwbGljZShpbmRleCwgMSk7DQogICAgICB0aGlzLmZvcm0ubm9kZXMuc3BsaWNlKGluZGV4IC0gMSwgMCwgdGVtcCk7DQogICAgICANCiAgICAgIC8vIOabtOaWsOmhuuW6jw0KICAgICAgdGhpcy51cGRhdGVOb2RlT3JkZXIoKTsNCiAgICB9LA0KICAgIG1vdmVEb3duKGluZGV4KSB7DQogICAgICBpZiAoaW5kZXggPT09IHRoaXMuZm9ybS5ub2Rlcy5sZW5ndGggLSAxKSByZXR1cm47DQogICAgICANCiAgICAgIGNvbnN0IHRlbXAgPSB0aGlzLmZvcm0ubm9kZXNbaW5kZXhdOw0KICAgICAgdGhpcy5mb3JtLm5vZGVzLnNwbGljZShpbmRleCwgMSk7DQogICAgICB0aGlzLmZvcm0ubm9kZXMuc3BsaWNlKGluZGV4ICsgMSwgMCwgdGVtcCk7DQogICAgICANCiAgICAgIC8vIOabtOaWsOmhuuW6jw0KICAgICAgdGhpcy51cGRhdGVOb2RlT3JkZXIoKTsNCiAgICB9LA0KICAgIHJlbW92ZU5vZGUoaW5kZXgpIHsNCiAgICAgIHRoaXMuZm9ybS5ub2Rlcy5zcGxpY2UoaW5kZXgsIDEpOw0KICAgICAgDQogICAgICAvLyDmm7TmlrDpobrluo8NCiAgICAgIHRoaXMudXBkYXRlTm9kZU9yZGVyKCk7DQogICAgfSwNCiAgICB1cGRhdGVOb2RlT3JkZXIoKSB7DQogICAgICAvLyDmm7TmlrDoioLngrnpobrluo8NCiAgICAgIHRoaXMuZm9ybS5ub2Rlcy5mb3JFYWNoKChub2RlLCBpbmRleCkgPT4gew0KICAgICAgICBub2RlLm5vZGVfb3JkZXIgPSBpbmRleCArIDE7DQogICAgICB9KTsNCiAgICB9LA0KICAgIGZvcm1hdFRpbWUodGltZSkgew0KICAgICAgaWYgKCF0aW1lKSByZXR1cm4gJy0nOw0KICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKHRpbWUpOw0KICAgICAgcmV0dXJuIGRhdGUudG9Mb2NhbGVTdHJpbmcoKTsNCiAgICB9LA0KICAgIGdldEZpbGVUeXBlVGFnKHR5cGUpIHsNCiAgICAgIHN3aXRjaCAodHlwZSkgew0KICAgICAgICBjYXNlICdweSc6DQogICAgICAgICAgcmV0dXJuICdwcmltYXJ5JzsNCiAgICAgICAgY2FzZSAnc2gnOg0KICAgICAgICAgIHJldHVybiAnc3VjY2Vzcyc7DQogICAgICAgIGNhc2UgJ2JhdCc6DQogICAgICAgICAgcmV0dXJuICd3YXJuaW5nJzsNCiAgICAgICAgY2FzZSAncHMxJzoNCiAgICAgICAgICByZXR1cm4gJ2Rhbmdlcic7DQogICAgICAgIGNhc2UgJ2pzJzoNCiAgICAgICAgICByZXR1cm4gJ2luZm8nOw0KICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgIHJldHVybiAnJzsNCiAgICAgIH0NCiAgICB9LA0KICAgIHN1Ym1pdEZvcm0oKSB7DQogICAgICB0aGlzLiRyZWZzLmZvcm0udmFsaWRhdGUodmFsaWQgPT4gew0KICAgICAgICBpZiAodmFsaWQpIHsNCiAgICAgICAgICBpZiAoIXRoaXMuZm9ybS5ub2Rlcy5sZW5ndGgpIHsNCiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+ivt+iHs+Wwkea3u+WKoOS4gOS4quiEmuacrOiKgueCuScpOw0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgIH0NCiAgICAgICAgICANCiAgICAgICAgICB0aGlzLnN1Ym1pdHRpbmcgPSB0cnVlOw0KICAgICAgICAgIA0KICAgICAgICAgIGlmICh0aGlzLmlzRWRpdCkgew0KICAgICAgICAgICAgdGhpcy51cGRhdGVDaGFpbigpOw0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICB0aGlzLmFkZENoYWluKCk7DQogICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgfSwNCiAgICBhZGRDaGFpbigpIHsNCiAgICAgIC8vIOWHhuWkh+iKgueCueaVsOaNrg0KICAgICAgY29uc3Qgbm9kZXMgPSB0aGlzLmZvcm0ubm9kZXMubWFwKG5vZGUgPT4gKHsNCiAgICAgICAgc2NyaXB0X2lkOiBub2RlLnNjcmlwdF9pZA0KICAgICAgfSkpOw0KICAgICAgDQogICAgICAvLyDlj5HpgIHor7fmsYINCiAgICAgIHRoaXMuJGF4aW9zLnBvc3QoJy9hcGkvY2hhaW5zJywgew0KICAgICAgICBuYW1lOiB0aGlzLmZvcm0ubmFtZSwNCiAgICAgICAgZGVzY3JpcHRpb246IHRoaXMuZm9ybS5kZXNjcmlwdGlvbiwNCiAgICAgICAgbm9kZXM6IG5vZGVzDQogICAgICB9KQ0KICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7DQogICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuY29kZSA9PT0gMCkgew0KICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCfmt7vliqDohJrmnKzpk77miJDlip8nKTsNCiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCcvY2hhaW5zJyk7DQogICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IocmVzcG9uc2UuZGF0YS5tZXNzYWdlIHx8ICfmt7vliqDohJrmnKzpk77lpLHotKUnKTsNCiAgICAgICAgICB9DQogICAgICAgIH0pDQogICAgICAgIC5jYXRjaChlcnJvciA9PiB7DQogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign5re75Yqg6ISa5pys6ZO+5aSx6LSlOiAnICsgZXJyb3IubWVzc2FnZSk7DQogICAgICAgIH0pDQogICAgICAgIC5maW5hbGx5KCgpID0+IHsNCiAgICAgICAgICB0aGlzLnN1Ym1pdHRpbmcgPSBmYWxzZTsNCiAgICAgICAgfSk7DQogICAgfSwNCiAgICB1cGRhdGVDaGFpbigpIHsNCiAgICAgIC8vIOWHhuWkh+iKgueCueaVsOaNrg0KICAgICAgY29uc3Qgbm9kZXMgPSB0aGlzLmZvcm0ubm9kZXMubWFwKG5vZGUgPT4gKHsNCiAgICAgICAgc2NyaXB0X2lkOiBub2RlLnNjcmlwdF9pZA0KICAgICAgfSkpOw0KICAgICAgDQogICAgICAvLyDlj5HpgIHor7fmsYINCiAgICAgIHRoaXMuJGF4aW9zLnB1dChgL2FwaS9jaGFpbnMvJHt0aGlzLmNoYWluSWR9YCwgew0KICAgICAgICBuYW1lOiB0aGlzLmZvcm0ubmFtZSwNCiAgICAgICAgZGVzY3JpcHRpb246IHRoaXMuZm9ybS5kZXNjcmlwdGlvbiwNCiAgICAgICAgbm9kZXM6IG5vZGVzDQogICAgICB9KQ0KICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7DQogICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuY29kZSA9PT0gMCkgew0KICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCfmm7TmlrDohJrmnKzpk77miJDlip8nKTsNCiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCcvY2hhaW5zJyk7DQogICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IocmVzcG9uc2UuZGF0YS5tZXNzYWdlIHx8ICfmm7TmlrDohJrmnKzpk77lpLHotKUnKTsNCiAgICAgICAgICB9DQogICAgICAgIH0pDQogICAgICAgIC5jYXRjaChlcnJvciA9PiB7DQogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign5pu05paw6ISa5pys6ZO+5aSx6LSlOiAnICsgZXJyb3IubWVzc2FnZSk7DQogICAgICAgIH0pDQogICAgICAgIC5maW5hbGx5KCgpID0+IHsNCiAgICAgICAgICB0aGlzLnN1Ym1pdHRpbmcgPSBmYWxzZTsNCiAgICAgICAgfSk7DQogICAgfSwNCiAgICBjYW5jZWwoKSB7DQogICAgICB0aGlzLiRyb3V0ZXIuZ28oLTEpOw0KICAgIH0NCiAgfQ0KfTsNCg=="},{"version":3,"sources":["ChainForm.vue"],"names":[],"mappings":";AA0HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ChainForm.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"chain-form\">\r\n    <div class=\"page-container\">\r\n      <h1 class=\"page-title\">{{ isEdit ? '编辑脚本链' : '添加脚本链' }}</h1>\r\n      \r\n      <el-form \r\n        ref=\"form\" \r\n        :model=\"form\" \r\n        :rules=\"rules\" \r\n        label-width=\"100px\" \r\n        class=\"form-container\"\r\n        v-loading=\"loading\"\r\n      >\r\n        <el-form-item label=\"脚本链名称\" prop=\"name\">\r\n          <el-input v-model=\"form.name\" placeholder=\"请输入脚本链名称\"></el-input>\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"脚本链描述\" prop=\"description\">\r\n          <el-input \r\n            type=\"textarea\" \r\n            v-model=\"form.description\" \r\n            placeholder=\"请输入脚本链描述\"\r\n            :rows=\"4\"\r\n          ></el-input>\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"脚本节点\">\r\n          <div class=\"nodes-header\">\r\n            <h3>脚本链节点列表</h3>\r\n            <el-button type=\"primary\" size=\"small\" @click=\"showScriptSelector\">\r\n              <i class=\"el-icon-plus\"></i> 添加脚本\r\n            </el-button>\r\n          </div>\r\n          \r\n          <el-empty v-if=\"!form.nodes.length\" description=\"请添加脚本节点\"></el-empty>\r\n          \r\n          <el-table v-else :data=\"form.nodes\" border style=\"width: 100%\">\r\n            <el-table-column type=\"index\" label=\"序号\" width=\"80\"></el-table-column>\r\n            <el-table-column prop=\"script_name\" label=\"脚本名称\" min-width=\"150\"></el-table-column>\r\n            <el-table-column prop=\"script_description\" label=\"脚本描述\" min-width=\"200\">\r\n              <template slot-scope=\"scope\">\r\n                {{ scope.row.script_description || '无描述' }}\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column prop=\"file_type\" label=\"类型\" width=\"100\">\r\n              <template slot-scope=\"scope\">\r\n                <el-tag :type=\"getFileTypeTag(scope.row.file_type)\">\r\n                  {{ scope.row.file_type }}\r\n                </el-tag>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"操作\" width=\"220\">\r\n              <template slot-scope=\"scope\">\r\n                <el-button\r\n                  size=\"mini\"\r\n                  icon=\"el-icon-top\"\r\n                  @click=\"moveUp(scope.$index)\"\r\n                  :disabled=\"scope.$index === 0\"\r\n                  circle\r\n                ></el-button>\r\n                <el-button\r\n                  size=\"mini\"\r\n                  icon=\"el-icon-bottom\"\r\n                  @click=\"moveDown(scope.$index)\"\r\n                  :disabled=\"scope.$index === form.nodes.length - 1\"\r\n                  circle\r\n                ></el-button>\r\n                <el-button\r\n                  size=\"mini\"\r\n                  type=\"danger\"\r\n                  icon=\"el-icon-delete\"\r\n                  @click=\"removeNode(scope.$index)\"\r\n                  circle\r\n                ></el-button>\r\n              </template>\r\n            </el-table-column>\r\n          </el-table>\r\n        </el-form-item>\r\n        \r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"submitForm\" :loading=\"submitting\">保存</el-button>\r\n          <el-button @click=\"cancel\">取消</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </div>\r\n    \r\n    <!-- 脚本选择对话框 -->\r\n    <el-dialog title=\"选择脚本\" :visible.sync=\"scriptSelectorVisible\" width=\"70%\">\r\n      <el-table\r\n        v-loading=\"scriptsLoading\"\r\n        :data=\"availableScripts\"\r\n        border\r\n        style=\"width: 100%\"\r\n        height=\"400px\"\r\n        @row-click=\"handleScriptClick\"\r\n      >\r\n        <el-table-column prop=\"id\" label=\"ID\" width=\"80\"></el-table-column>\r\n        <el-table-column prop=\"name\" label=\"脚本名称\" min-width=\"150\"></el-table-column>\r\n        <el-table-column prop=\"description\" label=\"描述\" min-width=\"200\"></el-table-column>\r\n        <el-table-column prop=\"file_type\" label=\"类型\" width=\"100\">\r\n          <template slot-scope=\"scope\">\r\n            <el-tag :type=\"getFileTypeTag(scope.row.file_type)\">\r\n              {{ scope.row.file_type }}\r\n            </el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"created_at\" label=\"创建时间\" width=\"180\">\r\n          <template slot-scope=\"scope\">\r\n            {{ formatTime(scope.row.created_at) }}\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      \r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <span class=\"hint-text\">点击表格行选择脚本</span>\r\n        <el-button @click=\"scriptSelectorVisible = false\">关闭</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'ChainForm',\r\n  data() {\r\n    return {\r\n      isEdit: false,\r\n      chainId: null,\r\n      form: {\r\n        name: '',\r\n        description: '',\r\n        nodes: []\r\n      },\r\n      rules: {\r\n        name: [\r\n          { required: true, message: '请输入脚本链名称', trigger: 'blur' },\r\n          { min: 2, max: 50, message: '长度在 2 到 50 个字符', trigger: 'blur' }\r\n        ]\r\n      },\r\n      loading: false,\r\n      submitting: false,\r\n      scriptSelectorVisible: false,\r\n      availableScripts: [],\r\n      scriptsLoading: false\r\n    };\r\n  },\r\n  created() {\r\n    // 判断是否为编辑模式\r\n    this.chainId = this.$route.params.id;\r\n    this.isEdit = this.$route.name === 'ChainEdit';\r\n    \r\n    if (this.isEdit) {\r\n      this.fetchChainDetail();\r\n    }\r\n    \r\n    // 获取可用脚本列表\r\n    this.fetchScripts();\r\n  },\r\n  methods: {\r\n    fetchChainDetail() {\r\n      this.loading = true;\r\n      this.$axios.get(`/api/chains/${this.chainId}`)\r\n        .then(response => {\r\n          if (response.data.code === 0) {\r\n            const chain = response.data.data;\r\n            this.form.name = chain.name;\r\n            this.form.description = chain.description;\r\n            \r\n            // 处理节点\r\n            if (chain.nodes && chain.nodes.length) {\r\n              this.form.nodes = chain.nodes.map(node => ({\r\n                script_id: node.script_id,\r\n                script_name: node.script_name,\r\n                script_description: node.script_description,\r\n                file_type: node.file_type,\r\n                node_order: node.node_order\r\n              }));\r\n            }\r\n          } else {\r\n            this.$message.error(response.data.message || '获取脚本链详情失败');\r\n            this.$router.push('/chains');\r\n          }\r\n        })\r\n        .catch(error => {\r\n          this.$message.error('获取脚本链详情失败: ' + error.message);\r\n          this.$router.push('/chains');\r\n        })\r\n        .finally(() => {\r\n          this.loading = false;\r\n        });\r\n    },\r\n    fetchScripts() {\r\n      this.scriptsLoading = true;\r\n      this.$axios.get('/api/scripts')\r\n        .then(response => {\r\n          if (response.data.code === 0) {\r\n            this.availableScripts = response.data.data || [];\r\n          } else {\r\n            this.$message.error(response.data.message || '获取脚本列表失败');\r\n          }\r\n        })\r\n        .catch(error => {\r\n          this.$message.error('获取脚本列表失败: ' + error.message);\r\n        })\r\n        .finally(() => {\r\n          this.scriptsLoading = false;\r\n        });\r\n    },\r\n    showScriptSelector() {\r\n      this.scriptSelectorVisible = true;\r\n    },\r\n    handleScriptClick(row) {\r\n      // 检查是否已经添加过该脚本\r\n      const exists = this.form.nodes.some(node => node.script_id === row.id);\r\n      if (exists) {\r\n        this.$message.warning('该脚本已添加到脚本链中');\r\n        return;\r\n      }\r\n      \r\n      // 添加到节点列表\r\n      this.form.nodes.push({\r\n        script_id: row.id,\r\n        script_name: row.name,\r\n        script_description: row.description,\r\n        file_type: row.file_type,\r\n        node_order: this.form.nodes.length + 1\r\n      });\r\n      \r\n      this.scriptSelectorVisible = false;\r\n      this.$message.success(`已添加脚本: ${row.name}`);\r\n    },\r\n    moveUp(index) {\r\n      if (index === 0) return;\r\n      \r\n      const temp = this.form.nodes[index];\r\n      this.form.nodes.splice(index, 1);\r\n      this.form.nodes.splice(index - 1, 0, temp);\r\n      \r\n      // 更新顺序\r\n      this.updateNodeOrder();\r\n    },\r\n    moveDown(index) {\r\n      if (index === this.form.nodes.length - 1) return;\r\n      \r\n      const temp = this.form.nodes[index];\r\n      this.form.nodes.splice(index, 1);\r\n      this.form.nodes.splice(index + 1, 0, temp);\r\n      \r\n      // 更新顺序\r\n      this.updateNodeOrder();\r\n    },\r\n    removeNode(index) {\r\n      this.form.nodes.splice(index, 1);\r\n      \r\n      // 更新顺序\r\n      this.updateNodeOrder();\r\n    },\r\n    updateNodeOrder() {\r\n      // 更新节点顺序\r\n      this.form.nodes.forEach((node, index) => {\r\n        node.node_order = index + 1;\r\n      });\r\n    },\r\n    formatTime(time) {\r\n      if (!time) return '-';\r\n      const date = new Date(time);\r\n      return date.toLocaleString();\r\n    },\r\n    getFileTypeTag(type) {\r\n      switch (type) {\r\n        case 'py':\r\n          return 'primary';\r\n        case 'sh':\r\n          return 'success';\r\n        case 'bat':\r\n          return 'warning';\r\n        case 'ps1':\r\n          return 'danger';\r\n        case 'js':\r\n          return 'info';\r\n        default:\r\n          return '';\r\n      }\r\n    },\r\n    submitForm() {\r\n      this.$refs.form.validate(valid => {\r\n        if (valid) {\r\n          if (!this.form.nodes.length) {\r\n            this.$message.error('请至少添加一个脚本节点');\r\n            return;\r\n          }\r\n          \r\n          this.submitting = true;\r\n          \r\n          if (this.isEdit) {\r\n            this.updateChain();\r\n          } else {\r\n            this.addChain();\r\n          }\r\n        } else {\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    addChain() {\r\n      // 准备节点数据\r\n      const nodes = this.form.nodes.map(node => ({\r\n        script_id: node.script_id\r\n      }));\r\n      \r\n      // 发送请求\r\n      this.$axios.post('/api/chains', {\r\n        name: this.form.name,\r\n        description: this.form.description,\r\n        nodes: nodes\r\n      })\r\n        .then(response => {\r\n          if (response.data.code === 0) {\r\n            this.$message.success('添加脚本链成功');\r\n            this.$router.push('/chains');\r\n          } else {\r\n            this.$message.error(response.data.message || '添加脚本链失败');\r\n          }\r\n        })\r\n        .catch(error => {\r\n          this.$message.error('添加脚本链失败: ' + error.message);\r\n        })\r\n        .finally(() => {\r\n          this.submitting = false;\r\n        });\r\n    },\r\n    updateChain() {\r\n      // 准备节点数据\r\n      const nodes = this.form.nodes.map(node => ({\r\n        script_id: node.script_id\r\n      }));\r\n      \r\n      // 发送请求\r\n      this.$axios.put(`/api/chains/${this.chainId}`, {\r\n        name: this.form.name,\r\n        description: this.form.description,\r\n        nodes: nodes\r\n      })\r\n        .then(response => {\r\n          if (response.data.code === 0) {\r\n            this.$message.success('更新脚本链成功');\r\n            this.$router.push('/chains');\r\n          } else {\r\n            this.$message.error(response.data.message || '更新脚本链失败');\r\n          }\r\n        })\r\n        .catch(error => {\r\n          this.$message.error('更新脚本链失败: ' + error.message);\r\n        })\r\n        .finally(() => {\r\n          this.submitting = false;\r\n        });\r\n    },\r\n    cancel() {\r\n      this.$router.go(-1);\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.nodes-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 10px;\r\n  \r\n  h3 {\r\n    margin: 0;\r\n  }\r\n}\r\n\r\n.hint-text {\r\n  color: #909399;\r\n  margin-right: 15px;\r\n}\r\n</style>\r\n"]}]}