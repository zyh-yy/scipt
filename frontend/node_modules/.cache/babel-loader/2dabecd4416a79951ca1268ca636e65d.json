{"remainingRequest":"C:\\Users\\zhuyu\\Desktop\\study\\lijialu\\scipt\\frontend\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\zhuyu\\Desktop\\study\\lijialu\\scipt\\frontend\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\zhuyu\\Desktop\\study\\lijialu\\scipt\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\zhuyu\\Desktop\\study\\lijialu\\scipt\\frontend\\src\\views\\ChainForm.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\zhuyu\\Desktop\\study\\lijialu\\scipt\\frontend\\src\\views\\ChainForm.vue","mtime":1747313407929},{"path":"C:\\Users\\zhuyu\\Desktop\\study\\lijialu\\scipt\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1747314279003},{"path":"C:\\Users\\zhuyu\\Desktop\\study\\lijialu\\scipt\\frontend\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js","mtime":1747314323395},{"path":"C:\\Users\\zhuyu\\Desktop\\study\\lijialu\\scipt\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1747314279003},{"path":"C:\\Users\\zhuyu\\Desktop\\study\\lijialu\\scipt\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":1747314281934}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdDaGFpbkZvcm0nLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBpc0VkaXQ6IGZhbHNlLAogICAgICBjaGFpbklkOiBudWxsLAogICAgICBmb3JtOiB7CiAgICAgICAgbmFtZTogJycsCiAgICAgICAgZGVzY3JpcHRpb246ICcnLAogICAgICAgIG5vZGVzOiBbXQogICAgICB9LAogICAgICBydWxlczogewogICAgICAgIG5hbWU6IFt7CiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICAgIG1lc3NhZ2U6ICfor7fovpPlhaXohJrmnKzpk77lkI3np7AnLAogICAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgICAgfSwgewogICAgICAgICAgbWluOiAyLAogICAgICAgICAgbWF4OiA1MCwKICAgICAgICAgIG1lc3NhZ2U6ICfplb/luqblnKggMiDliLAgNTAg5Liq5a2X56ymJywKICAgICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICAgIH1dCiAgICAgIH0sCiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICBzdWJtaXR0aW5nOiBmYWxzZSwKICAgICAgc2NyaXB0U2VsZWN0b3JWaXNpYmxlOiBmYWxzZSwKICAgICAgYXZhaWxhYmxlU2NyaXB0czogW10sCiAgICAgIHNjcmlwdHNMb2FkaW5nOiBmYWxzZQogICAgfTsKICB9LAogIGNyZWF0ZWQoKSB7CiAgICAvLyDliKTmlq3mmK/lkKbkuLrnvJbovpHmqKHlvI8KICAgIHRoaXMuY2hhaW5JZCA9IHRoaXMuJHJvdXRlLnBhcmFtcy5pZDsKICAgIHRoaXMuaXNFZGl0ID0gdGhpcy4kcm91dGUubmFtZSA9PT0gJ0NoYWluRWRpdCc7CiAgICBpZiAodGhpcy5pc0VkaXQpIHsKICAgICAgdGhpcy5mZXRjaENoYWluRGV0YWlsKCk7CiAgICB9CgogICAgLy8g6I635Y+W5Y+v55So6ISa5pys5YiX6KGoCiAgICB0aGlzLmZldGNoU2NyaXB0cygpOwogIH0sCiAgbWV0aG9kczogewogICAgZmV0Y2hDaGFpbkRldGFpbCgpIHsKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgdGhpcy4kYXhpb3MuZ2V0KGAvYXBpL2NoYWlucy8ke3RoaXMuY2hhaW5JZH1gKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5jb2RlID09PSAwKSB7CiAgICAgICAgICBjb25zdCBjaGFpbiA9IHJlc3BvbnNlLmRhdGEuZGF0YTsKICAgICAgICAgIHRoaXMuZm9ybS5uYW1lID0gY2hhaW4ubmFtZTsKICAgICAgICAgIHRoaXMuZm9ybS5kZXNjcmlwdGlvbiA9IGNoYWluLmRlc2NyaXB0aW9uOwoKICAgICAgICAgIC8vIOWkhOeQhuiKgueCuQogICAgICAgICAgaWYgKGNoYWluLm5vZGVzICYmIGNoYWluLm5vZGVzLmxlbmd0aCkgewogICAgICAgICAgICB0aGlzLmZvcm0ubm9kZXMgPSBjaGFpbi5ub2Rlcy5tYXAobm9kZSA9PiAoewogICAgICAgICAgICAgIHNjcmlwdF9pZDogbm9kZS5zY3JpcHRfaWQsCiAgICAgICAgICAgICAgc2NyaXB0X25hbWU6IG5vZGUuc2NyaXB0X25hbWUsCiAgICAgICAgICAgICAgc2NyaXB0X2Rlc2NyaXB0aW9uOiBub2RlLnNjcmlwdF9kZXNjcmlwdGlvbiwKICAgICAgICAgICAgICBmaWxlX3R5cGU6IG5vZGUuZmlsZV90eXBlLAogICAgICAgICAgICAgIG5vZGVfb3JkZXI6IG5vZGUubm9kZV9vcmRlcgogICAgICAgICAgICB9KSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IocmVzcG9uc2UuZGF0YS5tZXNzYWdlIHx8ICfojrflj5bohJrmnKzpk77or6bmg4XlpLHotKUnKTsKICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCcvY2hhaW5zJyk7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign6I635Y+W6ISa5pys6ZO+6K+m5oOF5aSx6LSlOiAnICsgZXJyb3IubWVzc2FnZSk7CiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy9jaGFpbnMnKTsKICAgICAgfSkuZmluYWxseSgoKSA9PiB7CiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgIH0pOwogICAgfSwKICAgIGZldGNoU2NyaXB0cygpIHsKICAgICAgdGhpcy5zY3JpcHRzTG9hZGluZyA9IHRydWU7CiAgICAgIHRoaXMuJGF4aW9zLmdldCgnL2FwaS9zY3JpcHRzJykudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuY29kZSA9PT0gMCkgewogICAgICAgICAgdGhpcy5hdmFpbGFibGVTY3JpcHRzID0gcmVzcG9uc2UuZGF0YS5kYXRhIHx8IFtdOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHJlc3BvbnNlLmRhdGEubWVzc2FnZSB8fCAn6I635Y+W6ISa5pys5YiX6KGo5aSx6LSlJyk7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign6I635Y+W6ISa5pys5YiX6KGo5aSx6LSlOiAnICsgZXJyb3IubWVzc2FnZSk7CiAgICAgIH0pLmZpbmFsbHkoKCkgPT4gewogICAgICAgIHRoaXMuc2NyaXB0c0xvYWRpbmcgPSBmYWxzZTsKICAgICAgfSk7CiAgICB9LAogICAgc2hvd1NjcmlwdFNlbGVjdG9yKCkgewogICAgICB0aGlzLnNjcmlwdFNlbGVjdG9yVmlzaWJsZSA9IHRydWU7CiAgICB9LAogICAgaGFuZGxlU2NyaXB0Q2xpY2socm93KSB7CiAgICAgIC8vIOajgOafpeaYr+WQpuW3sue7j+a3u+WKoOi/h+ivpeiEmuacrAogICAgICBjb25zdCBleGlzdHMgPSB0aGlzLmZvcm0ubm9kZXMuc29tZShub2RlID0+IG5vZGUuc2NyaXB0X2lkID09PSByb3cuaWQpOwogICAgICBpZiAoZXhpc3RzKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCfor6XohJrmnKzlt7Lmt7vliqDliLDohJrmnKzpk77kuK0nKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIC8vIOa3u+WKoOWIsOiKgueCueWIl+ihqAogICAgICB0aGlzLmZvcm0ubm9kZXMucHVzaCh7CiAgICAgICAgc2NyaXB0X2lkOiByb3cuaWQsCiAgICAgICAgc2NyaXB0X25hbWU6IHJvdy5uYW1lLAogICAgICAgIHNjcmlwdF9kZXNjcmlwdGlvbjogcm93LmRlc2NyaXB0aW9uLAogICAgICAgIGZpbGVfdHlwZTogcm93LmZpbGVfdHlwZSwKICAgICAgICBub2RlX29yZGVyOiB0aGlzLmZvcm0ubm9kZXMubGVuZ3RoICsgMQogICAgICB9KTsKICAgICAgdGhpcy5zY3JpcHRTZWxlY3RvclZpc2libGUgPSBmYWxzZTsKICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKGDlt7Lmt7vliqDohJrmnKw6ICR7cm93Lm5hbWV9YCk7CiAgICB9LAogICAgbW92ZVVwKGluZGV4KSB7CiAgICAgIGlmIChpbmRleCA9PT0gMCkgcmV0dXJuOwogICAgICBjb25zdCB0ZW1wID0gdGhpcy5mb3JtLm5vZGVzW2luZGV4XTsKICAgICAgdGhpcy5mb3JtLm5vZGVzLnNwbGljZShpbmRleCwgMSk7CiAgICAgIHRoaXMuZm9ybS5ub2Rlcy5zcGxpY2UoaW5kZXggLSAxLCAwLCB0ZW1wKTsKCiAgICAgIC8vIOabtOaWsOmhuuW6jwogICAgICB0aGlzLnVwZGF0ZU5vZGVPcmRlcigpOwogICAgfSwKICAgIG1vdmVEb3duKGluZGV4KSB7CiAgICAgIGlmIChpbmRleCA9PT0gdGhpcy5mb3JtLm5vZGVzLmxlbmd0aCAtIDEpIHJldHVybjsKICAgICAgY29uc3QgdGVtcCA9IHRoaXMuZm9ybS5ub2Rlc1tpbmRleF07CiAgICAgIHRoaXMuZm9ybS5ub2Rlcy5zcGxpY2UoaW5kZXgsIDEpOwogICAgICB0aGlzLmZvcm0ubm9kZXMuc3BsaWNlKGluZGV4ICsgMSwgMCwgdGVtcCk7CgogICAgICAvLyDmm7TmlrDpobrluo8KICAgICAgdGhpcy51cGRhdGVOb2RlT3JkZXIoKTsKICAgIH0sCiAgICByZW1vdmVOb2RlKGluZGV4KSB7CiAgICAgIHRoaXMuZm9ybS5ub2Rlcy5zcGxpY2UoaW5kZXgsIDEpOwoKICAgICAgLy8g5pu05paw6aG65bqPCiAgICAgIHRoaXMudXBkYXRlTm9kZU9yZGVyKCk7CiAgICB9LAogICAgdXBkYXRlTm9kZU9yZGVyKCkgewogICAgICAvLyDmm7TmlrDoioLngrnpobrluo8KICAgICAgdGhpcy5mb3JtLm5vZGVzLmZvckVhY2goKG5vZGUsIGluZGV4KSA9PiB7CiAgICAgICAgbm9kZS5ub2RlX29yZGVyID0gaW5kZXggKyAxOwogICAgICB9KTsKICAgIH0sCiAgICBmb3JtYXRUaW1lKHRpbWUpIHsKICAgICAgaWYgKCF0aW1lKSByZXR1cm4gJy0nOwogICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUodGltZSk7CiAgICAgIHJldHVybiBkYXRlLnRvTG9jYWxlU3RyaW5nKCk7CiAgICB9LAogICAgZ2V0RmlsZVR5cGVUYWcodHlwZSkgewogICAgICBzd2l0Y2ggKHR5cGUpIHsKICAgICAgICBjYXNlICdweSc6CiAgICAgICAgICByZXR1cm4gJ3ByaW1hcnknOwogICAgICAgIGNhc2UgJ3NoJzoKICAgICAgICAgIHJldHVybiAnc3VjY2Vzcyc7CiAgICAgICAgY2FzZSAnYmF0JzoKICAgICAgICAgIHJldHVybiAnd2FybmluZyc7CiAgICAgICAgY2FzZSAncHMxJzoKICAgICAgICAgIHJldHVybiAnZGFuZ2VyJzsKICAgICAgICBjYXNlICdqcyc6CiAgICAgICAgICByZXR1cm4gJ2luZm8nOwogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICByZXR1cm4gJyc7CiAgICAgIH0KICAgIH0sCiAgICBzdWJtaXRGb3JtKCkgewogICAgICB0aGlzLiRyZWZzLmZvcm0udmFsaWRhdGUodmFsaWQgPT4gewogICAgICAgIGlmICh2YWxpZCkgewogICAgICAgICAgaWYgKCF0aGlzLmZvcm0ubm9kZXMubGVuZ3RoKSB7CiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+ivt+iHs+Wwkea3u+WKoOS4gOS4quiEmuacrOiKgueCuScpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLnN1Ym1pdHRpbmcgPSB0cnVlOwogICAgICAgICAgaWYgKHRoaXMuaXNFZGl0KSB7CiAgICAgICAgICAgIHRoaXMudXBkYXRlQ2hhaW4oKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMuYWRkQ2hhaW4oKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgYWRkQ2hhaW4oKSB7CiAgICAgIC8vIOWHhuWkh+iKgueCueaVsOaNrgogICAgICBjb25zdCBub2RlcyA9IHRoaXMuZm9ybS5ub2Rlcy5tYXAobm9kZSA9PiAoewogICAgICAgIHNjcmlwdF9pZDogbm9kZS5zY3JpcHRfaWQKICAgICAgfSkpOwoKICAgICAgLy8g5Y+R6YCB6K+35rGCCiAgICAgIHRoaXMuJGF4aW9zLnBvc3QoJy9hcGkvY2hhaW5zJywgewogICAgICAgIG5hbWU6IHRoaXMuZm9ybS5uYW1lLAogICAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLmZvcm0uZGVzY3JpcHRpb24sCiAgICAgICAgbm9kZXM6IG5vZGVzCiAgICAgIH0pLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIGlmIChyZXNwb25zZS5kYXRhLmNvZGUgPT09IDApIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn5re75Yqg6ISa5pys6ZO+5oiQ5YqfJyk7CiAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCgnL2NoYWlucycpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHJlc3BvbnNlLmRhdGEubWVzc2FnZSB8fCAn5re75Yqg6ISa5pys6ZO+5aSx6LSlJyk7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign5re75Yqg6ISa5pys6ZO+5aSx6LSlOiAnICsgZXJyb3IubWVzc2FnZSk7CiAgICAgIH0pLmZpbmFsbHkoKCkgPT4gewogICAgICAgIHRoaXMuc3VibWl0dGluZyA9IGZhbHNlOwogICAgICB9KTsKICAgIH0sCiAgICB1cGRhdGVDaGFpbigpIHsKICAgICAgLy8g5YeG5aSH6IqC54K55pWw5o2uCiAgICAgIGNvbnN0IG5vZGVzID0gdGhpcy5mb3JtLm5vZGVzLm1hcChub2RlID0+ICh7CiAgICAgICAgc2NyaXB0X2lkOiBub2RlLnNjcmlwdF9pZAogICAgICB9KSk7CgogICAgICAvLyDlj5HpgIHor7fmsYIKICAgICAgdGhpcy4kYXhpb3MucHV0KGAvYXBpL2NoYWlucy8ke3RoaXMuY2hhaW5JZH1gLCB7CiAgICAgICAgbmFtZTogdGhpcy5mb3JtLm5hbWUsCiAgICAgICAgZGVzY3JpcHRpb246IHRoaXMuZm9ybS5kZXNjcmlwdGlvbiwKICAgICAgICBub2Rlczogbm9kZXMKICAgICAgfSkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuY29kZSA9PT0gMCkgewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCfmm7TmlrDohJrmnKzpk77miJDlip8nKTsKICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCcvY2hhaW5zJyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IocmVzcG9uc2UuZGF0YS5tZXNzYWdlIHx8ICfmm7TmlrDohJrmnKzpk77lpLHotKUnKTsKICAgICAgICB9CiAgICAgIH0pLmNhdGNoKGVycm9yID0+IHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfmm7TmlrDohJrmnKzpk77lpLHotKU6ICcgKyBlcnJvci5tZXNzYWdlKTsKICAgICAgfSkuZmluYWxseSgoKSA9PiB7CiAgICAgICAgdGhpcy5zdWJtaXR0aW5nID0gZmFsc2U7CiAgICAgIH0pOwogICAgfSwKICAgIGNhbmNlbCgpIHsKICAgICAgdGhpcy4kcm91dGVyLmdvKC0xKTsKICAgIH0KICB9Cn07"},{"version":3,"names":["name","data","isEdit","chainId","form","description","nodes","rules","required","message","trigger","min","max","loading","submitting","scriptSelectorVisible","availableScripts","scriptsLoading","created","$route","params","id","fetchChainDetail","fetchScripts","methods","$axios","get","then","response","code","chain","length","map","node","script_id","script_name","script_description","file_type","node_order","$message","error","$router","push","catch","finally","showScriptSelector","handleScriptClick","row","exists","some","warning","success","moveUp","index","temp","splice","updateNodeOrder","moveDown","removeNode","forEach","formatTime","time","date","Date","toLocaleString","getFileTypeTag","type","submitForm","$refs","validate","valid","updateChain","addChain","post","put","cancel","go"],"sources":["src/views/ChainForm.vue"],"sourcesContent":["<template>\r\n  <div class=\"chain-form\">\r\n    <div class=\"page-container\">\r\n      <h1 class=\"page-title\">{{ isEdit ? '编辑脚本链' : '添加脚本链' }}</h1>\r\n      \r\n      <el-form \r\n        ref=\"form\" \r\n        :model=\"form\" \r\n        :rules=\"rules\" \r\n        label-width=\"100px\" \r\n        class=\"form-container\"\r\n        v-loading=\"loading\"\r\n      >\r\n        <el-form-item label=\"脚本链名称\" prop=\"name\">\r\n          <el-input v-model=\"form.name\" placeholder=\"请输入脚本链名称\"></el-input>\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"脚本链描述\" prop=\"description\">\r\n          <el-input \r\n            type=\"textarea\" \r\n            v-model=\"form.description\" \r\n            placeholder=\"请输入脚本链描述\"\r\n            :rows=\"4\"\r\n          ></el-input>\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"脚本节点\">\r\n          <div class=\"nodes-header\">\r\n            <h3>脚本链节点列表</h3>\r\n            <el-button type=\"primary\" size=\"small\" @click=\"showScriptSelector\">\r\n              <i class=\"el-icon-plus\"></i> 添加脚本\r\n            </el-button>\r\n          </div>\r\n          \r\n          <el-empty v-if=\"!form.nodes.length\" description=\"请添加脚本节点\"></el-empty>\r\n          \r\n          <el-table v-else :data=\"form.nodes\" border style=\"width: 100%\">\r\n            <el-table-column type=\"index\" label=\"序号\" width=\"80\"></el-table-column>\r\n            <el-table-column prop=\"script_name\" label=\"脚本名称\" min-width=\"150\"></el-table-column>\r\n            <el-table-column prop=\"script_description\" label=\"脚本描述\" min-width=\"200\">\r\n              <template slot-scope=\"scope\">\r\n                {{ scope.row.script_description || '无描述' }}\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column prop=\"file_type\" label=\"类型\" width=\"100\">\r\n              <template slot-scope=\"scope\">\r\n                <el-tag :type=\"getFileTypeTag(scope.row.file_type)\">\r\n                  {{ scope.row.file_type }}\r\n                </el-tag>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"操作\" width=\"220\">\r\n              <template slot-scope=\"scope\">\r\n                <el-button\r\n                  size=\"mini\"\r\n                  icon=\"el-icon-top\"\r\n                  @click=\"moveUp(scope.$index)\"\r\n                  :disabled=\"scope.$index === 0\"\r\n                  circle\r\n                ></el-button>\r\n                <el-button\r\n                  size=\"mini\"\r\n                  icon=\"el-icon-bottom\"\r\n                  @click=\"moveDown(scope.$index)\"\r\n                  :disabled=\"scope.$index === form.nodes.length - 1\"\r\n                  circle\r\n                ></el-button>\r\n                <el-button\r\n                  size=\"mini\"\r\n                  type=\"danger\"\r\n                  icon=\"el-icon-delete\"\r\n                  @click=\"removeNode(scope.$index)\"\r\n                  circle\r\n                ></el-button>\r\n              </template>\r\n            </el-table-column>\r\n          </el-table>\r\n        </el-form-item>\r\n        \r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"submitForm\" :loading=\"submitting\">保存</el-button>\r\n          <el-button @click=\"cancel\">取消</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </div>\r\n    \r\n    <!-- 脚本选择对话框 -->\r\n    <el-dialog title=\"选择脚本\" :visible.sync=\"scriptSelectorVisible\" width=\"70%\">\r\n      <el-table\r\n        v-loading=\"scriptsLoading\"\r\n        :data=\"availableScripts\"\r\n        border\r\n        style=\"width: 100%\"\r\n        height=\"400px\"\r\n        @row-click=\"handleScriptClick\"\r\n      >\r\n        <el-table-column prop=\"id\" label=\"ID\" width=\"80\"></el-table-column>\r\n        <el-table-column prop=\"name\" label=\"脚本名称\" min-width=\"150\"></el-table-column>\r\n        <el-table-column prop=\"description\" label=\"描述\" min-width=\"200\"></el-table-column>\r\n        <el-table-column prop=\"file_type\" label=\"类型\" width=\"100\">\r\n          <template slot-scope=\"scope\">\r\n            <el-tag :type=\"getFileTypeTag(scope.row.file_type)\">\r\n              {{ scope.row.file_type }}\r\n            </el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"created_at\" label=\"创建时间\" width=\"180\">\r\n          <template slot-scope=\"scope\">\r\n            {{ formatTime(scope.row.created_at) }}\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      \r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <span class=\"hint-text\">点击表格行选择脚本</span>\r\n        <el-button @click=\"scriptSelectorVisible = false\">关闭</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'ChainForm',\r\n  data() {\r\n    return {\r\n      isEdit: false,\r\n      chainId: null,\r\n      form: {\r\n        name: '',\r\n        description: '',\r\n        nodes: []\r\n      },\r\n      rules: {\r\n        name: [\r\n          { required: true, message: '请输入脚本链名称', trigger: 'blur' },\r\n          { min: 2, max: 50, message: '长度在 2 到 50 个字符', trigger: 'blur' }\r\n        ]\r\n      },\r\n      loading: false,\r\n      submitting: false,\r\n      scriptSelectorVisible: false,\r\n      availableScripts: [],\r\n      scriptsLoading: false\r\n    };\r\n  },\r\n  created() {\r\n    // 判断是否为编辑模式\r\n    this.chainId = this.$route.params.id;\r\n    this.isEdit = this.$route.name === 'ChainEdit';\r\n    \r\n    if (this.isEdit) {\r\n      this.fetchChainDetail();\r\n    }\r\n    \r\n    // 获取可用脚本列表\r\n    this.fetchScripts();\r\n  },\r\n  methods: {\r\n    fetchChainDetail() {\r\n      this.loading = true;\r\n      this.$axios.get(`/api/chains/${this.chainId}`)\r\n        .then(response => {\r\n          if (response.data.code === 0) {\r\n            const chain = response.data.data;\r\n            this.form.name = chain.name;\r\n            this.form.description = chain.description;\r\n            \r\n            // 处理节点\r\n            if (chain.nodes && chain.nodes.length) {\r\n              this.form.nodes = chain.nodes.map(node => ({\r\n                script_id: node.script_id,\r\n                script_name: node.script_name,\r\n                script_description: node.script_description,\r\n                file_type: node.file_type,\r\n                node_order: node.node_order\r\n              }));\r\n            }\r\n          } else {\r\n            this.$message.error(response.data.message || '获取脚本链详情失败');\r\n            this.$router.push('/chains');\r\n          }\r\n        })\r\n        .catch(error => {\r\n          this.$message.error('获取脚本链详情失败: ' + error.message);\r\n          this.$router.push('/chains');\r\n        })\r\n        .finally(() => {\r\n          this.loading = false;\r\n        });\r\n    },\r\n    fetchScripts() {\r\n      this.scriptsLoading = true;\r\n      this.$axios.get('/api/scripts')\r\n        .then(response => {\r\n          if (response.data.code === 0) {\r\n            this.availableScripts = response.data.data || [];\r\n          } else {\r\n            this.$message.error(response.data.message || '获取脚本列表失败');\r\n          }\r\n        })\r\n        .catch(error => {\r\n          this.$message.error('获取脚本列表失败: ' + error.message);\r\n        })\r\n        .finally(() => {\r\n          this.scriptsLoading = false;\r\n        });\r\n    },\r\n    showScriptSelector() {\r\n      this.scriptSelectorVisible = true;\r\n    },\r\n    handleScriptClick(row) {\r\n      // 检查是否已经添加过该脚本\r\n      const exists = this.form.nodes.some(node => node.script_id === row.id);\r\n      if (exists) {\r\n        this.$message.warning('该脚本已添加到脚本链中');\r\n        return;\r\n      }\r\n      \r\n      // 添加到节点列表\r\n      this.form.nodes.push({\r\n        script_id: row.id,\r\n        script_name: row.name,\r\n        script_description: row.description,\r\n        file_type: row.file_type,\r\n        node_order: this.form.nodes.length + 1\r\n      });\r\n      \r\n      this.scriptSelectorVisible = false;\r\n      this.$message.success(`已添加脚本: ${row.name}`);\r\n    },\r\n    moveUp(index) {\r\n      if (index === 0) return;\r\n      \r\n      const temp = this.form.nodes[index];\r\n      this.form.nodes.splice(index, 1);\r\n      this.form.nodes.splice(index - 1, 0, temp);\r\n      \r\n      // 更新顺序\r\n      this.updateNodeOrder();\r\n    },\r\n    moveDown(index) {\r\n      if (index === this.form.nodes.length - 1) return;\r\n      \r\n      const temp = this.form.nodes[index];\r\n      this.form.nodes.splice(index, 1);\r\n      this.form.nodes.splice(index + 1, 0, temp);\r\n      \r\n      // 更新顺序\r\n      this.updateNodeOrder();\r\n    },\r\n    removeNode(index) {\r\n      this.form.nodes.splice(index, 1);\r\n      \r\n      // 更新顺序\r\n      this.updateNodeOrder();\r\n    },\r\n    updateNodeOrder() {\r\n      // 更新节点顺序\r\n      this.form.nodes.forEach((node, index) => {\r\n        node.node_order = index + 1;\r\n      });\r\n    },\r\n    formatTime(time) {\r\n      if (!time) return '-';\r\n      const date = new Date(time);\r\n      return date.toLocaleString();\r\n    },\r\n    getFileTypeTag(type) {\r\n      switch (type) {\r\n        case 'py':\r\n          return 'primary';\r\n        case 'sh':\r\n          return 'success';\r\n        case 'bat':\r\n          return 'warning';\r\n        case 'ps1':\r\n          return 'danger';\r\n        case 'js':\r\n          return 'info';\r\n        default:\r\n          return '';\r\n      }\r\n    },\r\n    submitForm() {\r\n      this.$refs.form.validate(valid => {\r\n        if (valid) {\r\n          if (!this.form.nodes.length) {\r\n            this.$message.error('请至少添加一个脚本节点');\r\n            return;\r\n          }\r\n          \r\n          this.submitting = true;\r\n          \r\n          if (this.isEdit) {\r\n            this.updateChain();\r\n          } else {\r\n            this.addChain();\r\n          }\r\n        } else {\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    addChain() {\r\n      // 准备节点数据\r\n      const nodes = this.form.nodes.map(node => ({\r\n        script_id: node.script_id\r\n      }));\r\n      \r\n      // 发送请求\r\n      this.$axios.post('/api/chains', {\r\n        name: this.form.name,\r\n        description: this.form.description,\r\n        nodes: nodes\r\n      })\r\n        .then(response => {\r\n          if (response.data.code === 0) {\r\n            this.$message.success('添加脚本链成功');\r\n            this.$router.push('/chains');\r\n          } else {\r\n            this.$message.error(response.data.message || '添加脚本链失败');\r\n          }\r\n        })\r\n        .catch(error => {\r\n          this.$message.error('添加脚本链失败: ' + error.message);\r\n        })\r\n        .finally(() => {\r\n          this.submitting = false;\r\n        });\r\n    },\r\n    updateChain() {\r\n      // 准备节点数据\r\n      const nodes = this.form.nodes.map(node => ({\r\n        script_id: node.script_id\r\n      }));\r\n      \r\n      // 发送请求\r\n      this.$axios.put(`/api/chains/${this.chainId}`, {\r\n        name: this.form.name,\r\n        description: this.form.description,\r\n        nodes: nodes\r\n      })\r\n        .then(response => {\r\n          if (response.data.code === 0) {\r\n            this.$message.success('更新脚本链成功');\r\n            this.$router.push('/chains');\r\n          } else {\r\n            this.$message.error(response.data.message || '更新脚本链失败');\r\n          }\r\n        })\r\n        .catch(error => {\r\n          this.$message.error('更新脚本链失败: ' + error.message);\r\n        })\r\n        .finally(() => {\r\n          this.submitting = false;\r\n        });\r\n    },\r\n    cancel() {\r\n      this.$router.go(-1);\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.nodes-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 10px;\r\n  \r\n  h3 {\r\n    margin: 0;\r\n  }\r\n}\r\n\r\n.hint-text {\r\n  color: #909399;\r\n  margin-right: 15px;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]}]}